<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evaluating audit samples with partial misstatements • jfa</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Evaluating audit samples with partial misstatements">
<meta property="og:description" content="jfa">
<meta property="og:image" content="https://koenderks.github.io/jfa/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/jfa.html">Get started</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/koenderks/jfa" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/koenderks/jfa/discussions" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Evaluating audit samples with partial
misstatements</h1>
                        <h4 data-toc-skip class="author">Koen Derks</h4>
            
            <h4 data-toc-skip class="date">2023-12-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/koenderks/jfa/blob/HEAD/vignettes/sample-evaluation-partial.Rmd" class="external-link"><code>vignettes/sample-evaluation-partial.Rmd</code></a></small>
      <div class="hidden name"><code>sample-evaluation-partial.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Welcome to the ‘Evaluating audit samples with partial misstatements’
vignette of the <strong>jfa</strong> package. This page demonstrates how
to efficiently audit samples with partial misstatements using the
<code><a href="../reference/evaluation.html">evaluation()</a></code> function in the package.</p>
<p align="center">
<img src="evaluation.png" alt="evaluation" width="100%"></p>
<p>In auditing, the objective of evaluation is typically 1) to estimate
the misstatement in the population based on a sample or 2) to test the
misstatement against a critical upper limit, known as performance
materiality.</p>
</div>
<div class="section level2">
<h2 id="modeling-partial-misstatements">Modeling partial misstatements<a class="anchor" aria-label="anchor" href="#modeling-partial-misstatements"></a>
</h2>
<p>Partial misstatements occur when there is only a partial discrepancy
between the true value of an item in the sample and its recorded value.
From a data perspective, this implies that the misstatements in the
sample are not just binary (i.e., 0 or 1) but also often lie between 0
and 1. In practice, this means that the usual methods for evaluating
binary misstatements do not suffice.</p>
<p>To illustrate how auditors can adequately deal with this type of
misstatements, we examine a realistic sample from a financial audit
using the <code>allowances</code> data set included in the package. For
clarity, we perform some data pre-processing to arrive at the population
for our example. In this case, the performance materiality (i.e., the
maximum tolerable misstatement) for the population is set to ten
percent.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"allowances"</span><span class="op">)</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="va">allowances</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="va">population</span><span class="op">[</span><span class="va">population</span><span class="op">[[</span><span class="st">"bookValue"</span><span class="op">]</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="va">population</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">population</span><span class="op">[[</span><span class="st">"auditValue"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    item bookValue auditValue</span></span>
<span><span class="co">## 1     1      1600       1600</span></span>
<span><span class="co">## 4     4      1250       1250</span></span>
<span><span class="co">## 7     7      1150       1150</span></span>
<span><span class="co">## 10   10      1250       1250</span></span>
<span><span class="co">## 12   12      6700       6700</span></span>
<span><span class="co">## 13   13      1450       1450</span></span></code></pre>
<p>To decide whether the misstatement in the population is lower than
the performance materiality of ten percent, a sample of 60 items is
selected from the population of 1177 items. In this case, the sample is
selected using a fixed interval sampling method in which the items in
the population are randomized before selection.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">21</span><span class="op">)</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selection.html">selection</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">population</span>, size <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"interval"</span>, units <span class="op">=</span> <span class="st">"values"</span>, values <span class="op">=</span> <span class="st">"bookValue"</span>,</span>
<span>  randomize <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">sample</span></span></code></pre></div>
<p>After inspecting the items in the sample, each item is annotated with
its recorded (i.e., book) value and its true (i.e., audit) value. When
evaluating partial misstatements, auditors often calculate the ‘taint’
<span class="math inline">\(t_i\)</span> of each item <span class="math inline">\(i\)</span>, which is defined as the proportional
misstatement in the item:</p>
<p><span class="math display">\[t_i = \frac{\text{Book value}_i -
\text{Audit value}_i}{\text{Book value}_i}.\]</span></p>
<p>For instance, if item <span class="math inline">\(i\)</span> is
booked for $1,000 but has an audit value of $500 it has a taint of <span class="math inline">\(t_i\)</span> = 0.5. On the other hand, if the item
does not contain any misstatement, it has a taint of <span class="math inline">\(t_i\)</span> = 0. Lastly, if the item is fully
misstated (i.e., have a book value of $0), its taint is <span class="math inline">\(t_i\)</span> = 1.</p>
<p>As is often the case in practice, this audit sample contains many
items that are correct (34), some items that are fully misstated (4),
and some items that are partially misstated (22). The table below shows
the distribution of these misstatements.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample</span><span class="op">[[</span><span class="st">"difference"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sample</span><span class="op">[[</span><span class="st">"bookValue"</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">sample</span><span class="op">[[</span><span class="st">"auditValue"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">sample</span><span class="op">[[</span><span class="st">"taint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sample</span><span class="op">[[</span><span class="st">"difference"</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="va">sample</span><span class="op">[[</span><span class="st">"bookValue"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sample</span><span class="op">[[</span><span class="st">"taint"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##    0 0.02  0.1  0.2 0.25 0.33 0.35 0.38  0.5 0.53  0.6 0.75  0.8    1 </span></span>
<span><span class="co">##   34    1    6    1    3    2    2    1    2    1    1    1    1    4</span></span></code></pre>
<p>Typically, techniques for evaluating audit samples overlook the
prevalence of many zeros in the data. Yet, considering the abundance of
zeros while modeling the misstatement in the population can enhance the
auditor’s efficiency. In the following sections, we demonstrate several
approaches that can be used to deal with partial misstatements and show
how they improve the auditor’s efficiency.</p>
</div>
<div class="section level2">
<h2 id="classical-approaches">Classical approaches<a class="anchor" aria-label="anchor" href="#classical-approaches"></a>
</h2>
<p>Classical (i.e., frequentist) methods solely look to the data for
estimating the parameters in a statistical model via maximum likelihood
estimation. This methodology is widely adopted in auditing, and
therefore we will discuss it first in this vignette.</p>
<div class="section level3">
<h3 id="binomial-likelihood">Binomial likelihood<a class="anchor" aria-label="anchor" href="#binomial-likelihood"></a>
</h3>
<p>The easiest way to analyze partial misstatements is to aggregate them
and simply extrapolate the sum of proportional misstatements (i.e., the
total taint) to the population. Under the hood, this approach employs a
binomial likelihood to estimate the misstatement: <em>k</em> <span class="math inline">\(\sim\)</span> Binomial(<em>n</em>, <span class="math inline">\(\theta\)</span>). In this model, <span class="math inline">\(\theta\)</span> represents the misstatement in the
population. This method uses the sum of the taints, denoted as
<em>k</em> = <span class="math inline">\(\sum_{i=0}^n t_i\)</span> as
the number of misstatements, together with the sample size
<em>n</em>.</p>
<p>While aggregating the taints in this manner may not adhere to a
strictly ‘clean’ modeling approach, as the binomial likelihood is only
defined for binary data representing complete misstatements, it proves
to be effective in estimating the misstatement <span class="citation">(Broeze, 2006, Chapter 4.3)</span>. Despite its
somewhat unconventional nature, the analytical feasibility of this
approach makes it easy to use and therefore it is commonly applied in
practice.</p>
<p>For the classical binomial likelihood, aggregating the taints can be
done using <code>method = "binomial"</code> in the
<code><a href="../reference/evaluation.html">evaluation()</a></code> function. Using maximum likelihood estimation,
<span class="math inline">\(\theta\)</span> = <span class="math inline">\(\frac{\sum t}{n}\)</span> = <span class="math inline">\(\frac{11.003}{60}\)</span> = 0.18338.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval_binom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">sample</span>, materiality <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eval_binom</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  sample</span></span>
<span><span class="co">## number of errors = 26, number of samples = 60, taint = 11.003, p-value</span></span>
<span><span class="co">## = 0.98545</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.1</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.0000000 0.2852153</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.18338 </span></span>
<span><span class="co">## results obtained via method 'binomial'</span></span></code></pre>
<p>As shown in the output, the most likely misstatement is estimated to
be 18.34 percent, with a 95 percent upper bound of 28.52 percent. Note
that this approach might be effective (i.e., estimate the misstatement
well) but not not very efficient (i.e., has a relatively high upper
bound). That is because it does not take into account the information in
the distribution of the taints.</p>
</div>
<div class="section level3">
<h3 id="stringer-bound">Stringer bound<a class="anchor" aria-label="anchor" href="#stringer-bound"></a>
</h3>
<p>The Stringer bound is a frequentist method to improve efficiency by
taking into account the differences between the magnitude of the taints
<span class="citation">(Bickel, 1992; Stringer, 1963)</span>. The bound
is a variant of the binomial distribution, but considers the non-binary
nature of the taints. The Stringer upper bound on the population
misstatement is given by <span class="math inline">\(p(0, 1 -
\alpha)\)</span> + <span class="math inline">\(\sum_{i=1}^k [p(i, 1 -
\alpha) - p(i - 1, 1 - \alpha)] \cdot t_i\)</span>. In this formula,
<span class="math inline">\(p(i; 1 - \alpha)\)</span> is the 1 - <span class="math inline">\(\alpha\)</span> upper limit for at most <span class="math inline">\(i\)</span> misstatements in <em>n</em> items
according to the binomial distribution <span class="citation">(Clopper
&amp; Pearson, 1934)</span>. This is equal to the 1 - <span class="math inline">\(\alpha\)</span> percentile of a beta(1 +
<em>i</em>, <em>n</em> - <em>i</em>) distribution <span class="citation">(Pearson, 1948)</span>. When calculating the Stringer
bound, the taints are placed in descending order in the formula as a
form of conservatism.</p>
<p>In <strong>jfa</strong>, the Stringer bound can be applied using
<code>method = "stringer"</code> in the <code><a href="../reference/evaluation.html">evaluation()</a></code>
function. The maximum likelihood estimate for the Stringer bound is the
same as that of the binomial likelihood.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval_stringer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"stringer"</span>, data <span class="op">=</span> <span class="va">sample</span>, materiality <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eval_stringer</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  sample</span></span>
<span><span class="co">## number of errors = 26, number of samples = 60, taint = 11.003</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.0000000 0.2799705</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.18338 </span></span>
<span><span class="co">## results obtained via method 'stringer.binomial'</span></span></code></pre>
<p>As shown in the output, the most likely misstatement is estimated to
be 18.34 percent, with a 95 percent upper bound of 27.99 percent. Since
the upper bound of the Stringer method is (slightly) lower than that of
the binomial likelihood, the Stringer bound is more efficient.</p>
</div>
<div class="section level3">
<h3 id="hurdle-beta-model">Hurdle beta model<a class="anchor" aria-label="anchor" href="#hurdle-beta-model"></a>
</h3>
<p>Efficiency can be further improved by explicitly modeling the
probability of a taint being zero (i.e., zero-inflation). This is a more
realistic method because, in practice, most taints are zero. More
formally, if there are explicit zeros present in the data, a model that
incorporates a separate probability of being zero should be
unequivocally favored over a model that does not. That is because the
probability mass associated with the zeros in the adjusted model are
infinitely larger than their probability densities under the traditional
model.</p>
<p>In <strong>jfa</strong>, there are two types of models that
incorporate a probability of the taint being zero. These are the
zero-inflated Poisson model and the hurdle beta model. In the
zero-inflated Poisson model, the idea is to incorporate extra zeros into
the zeros already present in the Poisson distribution. However, this
idea does not directly apply to a “zero-inflated beta” model. Since the
beta likelihood cannot accommodate zeros, there are no zeros to inflate.
A more appropriate name for this model is therefore a hurdle (i.e.,
two-component) beta model. This terminology reflects the idea that the
model has to overcome the hurdle of zero values which are not inherently
part of the beta likelihood.</p>
<p>The formal specification of the hurdle beta model is given below.
Here, <span class="math inline">\(p_{(0, 1]}\)</span> is the probability
of a misstatement occurring, regardless of its size. Additionally, <span class="math inline">\(p_{1 | (0, 1]}\)</span> is the conditional
probability of a misstatement being a full misstatement. Furthermore,
<span class="math inline">\(\phi\)</span> is the average (non-zero-one)
taint and <span class="math inline">\(\nu\)</span> is the concentration
of these taints. The total misstatement in the population is <span class="math inline">\(\theta\)</span> = <span class="math inline">\(p_{(0, 1)}\)</span> <span class="math inline">\(\cdot\)</span> <span class="math inline">\(\phi\)</span> + <span class="math inline">\(p_{1}\)</span>.</p>
<p><span class="math display">\[\begin{align*}
t = \begin{cases}
    0 &amp; \text{with probability } p_{0} = 1 - p_{(0, 1]} \\
    \left(0, 1\right] &amp; \begin{cases}
      \text{Beta}(\phi \nu, (1 - \phi) \nu) &amp; \text{with probability
} p_{(0, 1)} = p_{(0, 1]} \cdot (1 - p_{1 | (0, 1]}) \\
      1 &amp; \text{with probability } p_{1} = p_{(0, 1]} \cdot p_{1 |
(0, 1]}
    \end{cases}
\end{cases}
\end{align*}\]</span></p>
<p>In <strong>jfa</strong>, this hurdle beta model can be fitted using
<code>method = "hurdle.beta"</code> in the <code><a href="../reference/evaluation.html">evaluation()</a></code>
function. To estimate the parameters in this model using the maximum
likelihood, we use the default option <code>prior = FALSE</code>. Using
maximum likelihood estimation, <span class="math inline">\(p_{(0,
1]}\)</span> = <span class="math inline">\(\frac{n_t}{n}\)</span> =
<span class="math inline">\(\frac{26}{60}\)</span> = 0.433, where <span class="math inline">\(n_t\)</span> is the number of misstatements, and
<span class="math inline">\(p_{1 | (0, 1]}\)</span> = <span class="math inline">\(\frac{n_1}{n_t}\)</span> = <span class="math inline">\(\frac{4}{26}\)</span> = 0.1539, where <span class="math inline">\(n_1\)</span> is the number of full misstatements.
Furthermore, <span class="math inline">\(\phi\)</span> = <span class="math inline">\(\frac{\sum t - n_1}{n_t - n_1}\)</span> = <span class="math inline">\(\frac{11.003 - 4}{26 - 4}\)</span> = 0.3183.
Hence, the most likely misstatement is estimated to be <span class="math inline">\(\theta\)</span> = (<span class="math inline">\(p_{(0, 1]}\)</span> <span class="math inline">\(\cdot\)</span> <span class="math inline">\((1-p_{1
| (0, 1]})\)</span> <span class="math inline">\(\cdot\)</span> <span class="math inline">\(\phi\)</span>) + (<span class="math inline">\(p_{(0, 1]}\)</span> <span class="math inline">\(\cdot\)</span> <span class="math inline">\(p_{1 |
(0, 1]}\)</span>) = (0.433 <span class="math inline">\(\cdot\)</span> (1
- 0.1539) <span class="math inline">\(\cdot\)</span> 0.3183) + (0.433
<span class="math inline">\(\cdot\)</span> 0.1539) = 0.18338. The upper
bound cannot be derived analytically and has to be determined by drawing
samples from the fitted model. Hence, it is recommended to call
<code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> before executing the following command to make
the results reproducible.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">eval_hurdle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"hurdle.beta"</span>, data <span class="op">=</span> <span class="va">sample</span>, materiality <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eval_hurdle</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  sample</span></span>
<span><span class="co">## number of errors = 26, number of samples = 60, taint = 11.003</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.1</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.0000000 0.2628182</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.18338 </span></span>
<span><span class="co">## results obtained via method 'hurdle.beta'</span></span></code></pre>
<p>As shown in the output, the most likely misstatement is estimated to
be 18.34 percent, with a 95 percent upper bound of around 26.28 percent.
Since the upper bound of the hurdle beta model is (slightly) lower than
that of the Stringer bound, the hurdle beta model is more efficient.</p>
<p>We leave it to the interested reader to apply the zero-inflated
Poisson model to the data from this sample using
<code>method = "inflated.poisson"</code>. Please note that this requires
specification of the number of items in the population
(<code>N.items</code>) and the number of monetary units in the
population (<code>N.units</code>).</p>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-approaches">Bayesian approaches<a class="anchor" aria-label="anchor" href="#bayesian-approaches"></a>
</h2>
<p>In the Bayesian framework, the auditor defines a prior distribution
for the parameters in the model. This approach offers a notable
advantage for models dealing with partial misstatement, as the prior
distribution has a regularizing effect, reducing the amount of data
required for reliable inferences. More specifically, frequentist models
cannot be optimized when there are no non-zero taints in the sample.
Additionally, the prior distribution enables auditors to integrate
pre-existing information about the misstatement into the statistical
analysis, thereby increasing efficiency when the auditor has
pre-existing information about the misstatement.</p>
<div class="section level3">
<h3 id="beta-distribution">Beta distribution<a class="anchor" aria-label="anchor" href="#beta-distribution"></a>
</h3>
<p>The prior distribution we typically assign in the binomial model is
the beta distribution. Just as we handle taints in the binomial
likelihood, they can also be aggregated given the prior distribution.
The statistical model is <em>k</em> <span class="math inline">\(\sim\)</span> Binomial(<em>n</em>, <span class="math inline">\(\theta\)</span>) and the prior distribution that
is used is <span class="math inline">\(\theta\)</span> <span class="math inline">\(\sim\)</span> Beta(<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>). Given the data <em>n</em> and
<em>k</em> = <span class="math inline">\(\sum t\)</span>, the posterior
distribution for the default beta(1, 1) prior distribution
(<code>prior = TRUE</code>) can be derived analytically and is <span class="math inline">\(\theta\)</span> <span class="math inline">\(\sim\)</span> Beta(<span class="math inline">\(\alpha\)</span> = 1 + <span class="math inline">\(\sum t\)</span>, <span class="math inline">\(\beta\)</span> = 1 + <em>n</em> - <span class="math inline">\(\sum t\)</span>).</p>
<p>For the binomial likelihood, this Bayesian model can be applied in
the <code><a href="../reference/evaluation.html">evaluation()</a></code> function using
<code>method = "binomial"</code> in comination with
<code>prior = TRUE</code>. However, the input for the <code>prior</code>
argument can also be an object created by the <code><a href="../reference/auditPrior.html">auditPrior()</a></code>
function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">sample</span>, materiality <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eval_beta</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  sample</span></span>
<span><span class="co">## number of errors = 26, number of samples = 60, taint = 11.003, BF₁₀ =</span></span>
<span><span class="co">## 0.15107</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.1</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.0000000 0.2808365</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.18338 </span></span>
<span><span class="co">## results obtained via method 'binomial' + 'prior'</span></span></code></pre>
<p>As shown in the output, the most likely misstatement is estimated to
be 18.34 percent, with a 95 percent upper bound of 28.1 percent. The
prior and posterior distribution can be visualized via the
<code>plot(..., type = "posterior")</code> command.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eval_beta</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation-partial_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="hurdle-beta-model-1">Hurdle beta model<a class="anchor" aria-label="anchor" href="#hurdle-beta-model-1"></a>
</h3>
<p>It is also possible to fit a Bayesian variant of the hurdle beta
model. This entails applying prior distributions for the parameters
<span class="math inline">\(p\)</span>, <span class="math inline">\(\phi\)</span>, and <span class="math inline">\(\nu\)</span>. The prior distributions used by
<strong>jfa</strong> for the Bayesian hurdle beta model are <span class="math inline">\(p_{(0, 1]}\)</span> <span class="math inline">\(\sim\)</span> Beta(<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>) (to be specified by the user),
<span class="math inline">\(p_{1 | (0, 1]}\)</span> <span class="math inline">\(\sim\)</span> Beta(1, 1), <span class="math inline">\(\phi\)</span> <span class="math inline">\(\sim\)</span> Beta(1, 1), and <span class="math inline">\(\nu\)</span> <span class="math inline">\(\sim\)</span> Pareto(1, <span class="math inline">\(\frac{3}{2}\)</span>).</p>
<p>This Bayesian hurdle beta model can be applied using
<code>method = "hurdle.beta"</code> in combination with
<code>prior = TRUE</code> (or an object created by the
<code><a href="../reference/auditPrior.html">auditPrior()</a></code> function) in the <code><a href="../reference/evaluation.html">evaluation()</a></code>
function. In this case, the posterior distribution cannot be determined
analytically and must be determined using MCMC sampling, which is why it
is recommended to call <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> before computing the
results.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">eval_hurdle_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"hurdle.beta"</span>, data <span class="op">=</span> <span class="va">sample</span>, materiality <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eval_hurdle_bayes</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  sample</span></span>
<span><span class="co">## number of errors = 26, number of samples = 60, taint = 11.003, BF₁₀ =</span></span>
<span><span class="co">## 0.0068887</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.1</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.0000000 0.2640163</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.1935 </span></span>
<span><span class="co">## results obtained via method 'hurdle.beta' + 'prior'</span></span></code></pre>
<p>As shown in the output, the most likely misstatement is estimated to
be 19.35 percent, with a 95 percent upper bound of around 26.4 percent.
The prior and posterior distribution can be visualized using the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eval_hurdle_bayes</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation-partial_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-bickel_1992" class="csl-entry">
Bickel, P. J. (1992). Inference and auditing: The <span>S</span>tringer
bound. <em>International Statistical Review/Revue Internationale de
Statistique</em>, 197–209. <a href="https://doi.org/10.2307/1403650" class="external-link">https://doi.org/10.2307/1403650</a>
</div>
<div id="ref-broeze_2006" class="csl-entry">
Broeze, G. B. (2006). <em>Validation of risk assessment in auditing</em>
[PhD thesis, Vrije Universiteit]. <a href="https://research.vu.nl/ws/portalfiles/portal/42174612/complete+dissertation.pdf" class="external-link">https://research.vu.nl/ws/portalfiles/portal/42174612/complete+dissertation.pdf</a>
</div>
<div id="ref-clopper_1934" class="csl-entry">
Clopper, C. J., &amp; Pearson, E. S. (1934). The use of confidence or
fiducial limits illustrated in the case of the binomial.
<em>Biometrika</em>, <em>26</em>(4), 404–413. <a href="https://doi.org/10.2307/2331986" class="external-link">https://doi.org/10.2307/2331986</a>
</div>
<div id="ref-pearson_1948" class="csl-entry">
Pearson, K. (1948). <em>Tables of the incomplete beta-function</em>.
Biometrika.
</div>
<div id="ref-stringer_1963" class="csl-entry">
Stringer, K. W. (1963). Practical aspects of statistical sampling in
auditing. <em>Proceedings of the Business and Economic Statistics
Section</em>, 405–411.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://koenderks.com" class="external-link">Koen Derks</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
