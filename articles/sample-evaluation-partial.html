<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evaluating samples with partial misstatements â€¢ jfa</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Evaluating samples with partial misstatements">
<meta property="og:description" content="jfa">
<meta property="og:image" content="https://koenderks.github.io/jfa/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/jfa.html">Get started</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/koenderks/jfa" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/koenderks/jfa/discussions" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Evaluating samples with partial
misstatements</h1>
                        <h4 data-toc-skip class="author">Koen Derks</h4>
            
            <h4 data-toc-skip class="date">2023-11-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/koenderks/jfa/blob/HEAD/vignettes/sample-evaluation-partial.Rmd" class="external-link"><code>vignettes/sample-evaluation-partial.Rmd</code></a></small>
      <div class="hidden name"><code>sample-evaluation-partial.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to efficiently evaluate a sample with
non-binary misstatements using the <code><a href="../reference/evaluation.html">evaluation()</a></code> function
from the <strong>jfa</strong> package.</p>
<p align="center">
<img src="evaluation.png" alt="evaluation" width="100%"></p>
<p>In auditing, the goal of the evaluation is typically to estimate the
misstatement in the population based on a sample, or to test the
misstatement in the population against a critical upper limit, referred
to as the performance materiality.</p>
</div>
<div class="section level2">
<h2 id="modeling-partial-misstatements">Modeling partial misstatements<a class="anchor" aria-label="anchor" href="#modeling-partial-misstatements"></a>
</h2>
<p>Partial misstatements occur when there is only a partial discrepancy
between the true value of an item in the sample and its recorded value.
From a data perspective, this implies that the misstatements are
sometimes non-binary. However, there is often a large amount of correct
items in the population. This can be taken into account when modeling
the misstatement in the population, thereby increasing efficiency.</p>
<p>As an example, we look at a realistic sample from a financial audit.
The sample consists of 50 items, each having a recorded (book) value and
a true (audit) value.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"allowances"</span><span class="op">)</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="va">allowances</span><span class="op">[</span><span class="va">allowances</span><span class="op">$</span><span class="va">bookValue</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">allowances</span><span class="op">$</span><span class="va">auditValue</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">allowances</span><span class="op">$</span><span class="va">auditValue</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="va">population</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      item bookValue auditValue</span></span>
<span><span class="co">## 3709 3709  817.7943   817.7943</span></span>
<span><span class="co">## 2955 2955 3084.5041  2313.3781</span></span>
<span><span class="co">## 554   554  330.1700   330.1700</span></span>
<span><span class="co">## 3471 3471  499.4546   499.4546</span></span>
<span><span class="co">## 1667 1667 4914.8513  4914.8513</span></span>
<span><span class="co">## 1230 1230  995.0000   995.0000</span></span></code></pre>
<div class="section level3">
<h3 id="beta-distribution">Beta distribution<a class="anchor" aria-label="anchor" href="#beta-distribution"></a>
</h3>
<p>The simplest way to analyze partial misstatements is to preted they
can be aggregated and use sum of partial misstatements (i.e., the total
taint) to project to the population. Because of its simplicity, it is
common practice to do this. In the Bayesian framework this would entail
using a prior and updating this prior with the aggregated information
from the sample. For the binomial likelihood, this is done using
<code>method = "binomial"</code> in combination with
<code>prior = TRUE</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">sample</span>, values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eval2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  sample</span></span>
<span><span class="co">## number of errors = 10, number of samples = 50, taint = 2.5607</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.0000000 0.1335162</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.051214 </span></span>
<span><span class="co">## results obtained via method 'binomial' + 'prior'</span></span></code></pre>
<p>As can be seen from the output, the most likely misstatement is
estimated to be 5.12 percent, with a 95 percent upper bound of 13.3
percent. Note that this estimate is not very efficient, as it does not
take into account the information in the distribution of the taints. The
prior and posterior distribution can be visualized via the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eval2</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation-partial_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="stringer-bound">Stringer bound<a class="anchor" aria-label="anchor" href="#stringer-bound"></a>
</h3>
<p>The Stringer bound is a method to improve efficiency by taking into
account the differences between the partial misstatements (i.e.,
taints). While conservative, this method can reduce the upper bound on
the misstatement compared to the beta distribution. This can be done
using <code>method = "stringer"</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"stringer"</span>, data <span class="op">=</span> <span class="va">sample</span>, values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eval1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  sample</span></span>
<span><span class="co">## number of errors = 10, number of samples = 50, taint = 2.5607</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.0000000 0.1280455</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.051214 </span></span>
<span><span class="co">## results obtained via method 'stringer.binomial'</span></span></code></pre>
<p>As can be seen from the output, the most likely misstatement is
estimated to be 5.12 percent, with a 95 percent upper bound of 12.8
percent. Since the upper bound of the Stringer method is lower than that
of the beta distribution, the Stringer bound is more efficient.</p>
</div>
<div class="section level3">
<h3 id="zero-inflated-beta-distribution">Zero-inflated beta distribution<a class="anchor" aria-label="anchor" href="#zero-inflated-beta-distribution"></a>
</h3>
<p>When compared to the Stringer bound and the beta distribution,
efficiency can be bolstered even further by explicitly modeling the
probability of a taint being zero. The reason that this is good practice
is because most of the observed taints will be zero in practice. This
can be done using <code>method = "inflated.beta"</code>, which requires
that <code>prior = TRUE</code> or an object created via the
<code><a href="../reference/auditPrior.html">auditPrior()</a></code> function. Note that this method also requires
that you specify the number of items (<code>N.items</code>) and the
number of monetary units (<code>N.units</code>) in the population.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"inflated.beta"</span>, data <span class="op">=</span> <span class="va">sample</span>, values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>,</span>
<span>  N.items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span>, N.units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">bookValue</span><span class="op">)</span>, prior <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eval3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  sample</span></span>
<span><span class="co">## number of errors = 10, number of samples = 50, taint = 2.5607</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.00000000 0.09568718</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.0453 </span></span>
<span><span class="co">## results obtained via method 'inflated.beta' + 'prior'</span></span></code></pre>
<p>As can be seen from the output, the most likely misstatement is
estimated to be around 4 percent, with a 95 percent upper bound of
around 10 percent. The prior and posterior distribution can be
visualized via the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eval3</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation-partial_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="zero-inflated-poisson-distribution">Zero-inflated Poisson distribution<a class="anchor" aria-label="anchor" href="#zero-inflated-poisson-distribution"></a>
</h3>
<p>Depending on whether the auditor thinks it is likely that the taints
follow a beta distribution, they can also decide that it is more likely
that the misstatements themselves can be described in terms of a Poisson
process. With the option <code>method = "inflated.poisson"</code>, the
auditor can apply the assumption of inflated zeros to the misstatement
amounts.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"inflated.poisson"</span>, data <span class="op">=</span> <span class="va">sample</span>, values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>,</span>
<span>  N.items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span>, N.units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">bookValue</span><span class="op">)</span>, prior <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eval4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  sample</span></span>
<span><span class="co">## number of errors = 10, number of samples = 50, taint = 2.5607</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.00000000 0.06588473</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.0423 </span></span>
<span><span class="co">## results obtained via method 'inflated.poisson' + 'prior'</span></span></code></pre>
<p>As can be seen from the output, the most likely misstatement is
estimated to be around 4 percent, with a 95 percent upper bound of
around 7 percent. The prior and posterior distribution can be visualized
via the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eval4</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation-partial_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://koenderks.com" class="external-link">Koen Derks</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
