<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evaluating statistical audit samples • jfa</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Evaluating statistical audit samples">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../articles/jfa.html">Get started</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/koenderks/jfa" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
<li>
  <a href="https://github.com/koenderks/jfa/discussions" class="external-link">
    <span class="fa fa-users"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Evaluating statistical audit samples</h1>
                        <h4 data-toc-skip class="author">Koen Derks</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/koenderks/jfa/blob/development/vignettes/articles/sample-evaluation.Rmd" class="external-link"><code>vignettes/articles/sample-evaluation.Rmd</code></a></small>
      <div class="hidden name"><code>sample-evaluation.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Welcome to the ‘Evaluating statistical audit samples’ vignette of the
<strong>jfa</strong> package. This page demonstrates how to evaluate the
misstatement in an audit sample using the <code><a href="../reference/evaluation.html">evaluation()</a></code>
function in package.</p>
<p align="center">
<img src="evaluation.png" alt="evaluation" width="100%"></p>
<p>In auditing, the objective of evaluation is typically 1) to estimate
the misstatement in the population based on a sample or 2) to test the
misstatement against a critical upper limit, known as performance
materiality.</p>
</div>
<div class="section level2">
<h2 id="required-information">Required information<a class="anchor" aria-label="anchor" href="#required-information"></a>
</h2>
<p>Firstly, to evaluate an audit sample using the
<code><a href="../reference/evaluation.html">evaluation()</a></code> function, the sample data must be available in
one of two formats:</p>
<ul>
<li>
<strong>Summary statistics:</strong> This includes (a vector of) the
number of items (<code>n</code>), (a vector of) the sum of
misstatements/taints (<code>x</code>) and optionally (a vector of) the
number of units in the population (<code>N.units</code>).</li>
<li>
<strong>Data:</strong> A <code>data.frame</code> that contains a
numeric column with book values (<code>values)</code>, a numeric column
with audit (i.e., true) values (<code>values.audit</code>), and
optionally a factor column indicating stratum membership
(<code>strata</code>).</li>
</ul>
<p>By default, <code><a href="../reference/evaluation.html">evaluation()</a></code> estimates the population
misstatement and returns a point estimate as well as a
confidence/credible interval around this estimate, expressed as a
percentage (<code>conf.level</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>⋅</mo><annotation encoding="application/x-tex">\cdot</annotation></semantics></math>
100). However, in audit sampling, the population is typically subject to
a certain maximum tolerable misstatement defined by the performance
materiality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">\theta_{max}</annotation></semantics></math>.
You can provide the performance materiality to the
<code><a href="../reference/evaluation.html">evaluation()</a></code> function as a fraction using the
<code>materiality</code> argument. In addition to the default
estimation, specifying a value for <code>materiality</code> triggers the
comparison of two competing hypotheses. The hypotheses being compared
depend on the input for the <code>alternative</code> argument.</p>
<ul>
<li>
<code>alternative = "less"</code> (default):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><mi>θ</mi><mo>&lt;</mo><msub><mi>θ</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_1:\theta&lt;\theta_{max}</annotation></semantics></math>
versus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>θ</mi><mo>≥</mo><msub><mi>θ</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_0:\theta\geq\theta_{max}</annotation></semantics></math>
</li>
<li>
<code>alternative = "greater"</code>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><mi>θ</mi><mo>&gt;</mo><msub><mi>θ</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_1:\theta&gt;\theta_{max}</annotation></semantics></math>
versus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>θ</mi><mo>≤</mo><msub><mi>θ</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_0:\theta\leq\theta_{max}</annotation></semantics></math>
</li>
<li>
<code>alternative = "two.sided"</code>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><mi>θ</mi><mo>≠</mo><msub><mi>θ</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_1:\theta \neq\theta_{max}</annotation></semantics></math>
versus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>θ</mi><mo>=</mo><msub><mi>θ</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_0:\theta=\theta_{max}</annotation></semantics></math>
</li>
</ul>
<p>Once the auditor has established the materiality (if applicable),
they must make a decision on whether to stratify the population.
Stratification is the process of dividing the population into smaller
subgroups that contain similar items, referred to as strata, and
selecting a sample from each stratum. In the following sections, we will
demonstrate how to evaluate statistical audit samples, both stratified
and non-stratified.</p>
</div>
<div class="section level2">
<h2 id="evaluation-using-summary-statistics">Evaluation using summary statistics<a class="anchor" aria-label="anchor" href="#evaluation-using-summary-statistics"></a>
</h2>
<p>We first consider the scenario where the auditor does not have access
to the sample data and wants to perform inference about the misstatement
using summary statistics from the sample.</p>
<div class="section level3">
<h3 id="non-stratified-samples">Non-stratified samples<a class="anchor" aria-label="anchor" href="#non-stratified-samples"></a>
</h3>
<p>In a non-stratified sampling approach, the auditor does not divide
the population into different strata. This approach might be suitable
when the auditor is auditing the general ledger of a small business and
has substantiated that the population comprises homogeneous items, such
as all items being employment contracts subject to a shared ensemble of
control systems.</p>
<div class="section level4">
<h4 id="classical-approach">Classical approach<a class="anchor" aria-label="anchor" href="#classical-approach"></a>
</h4>
<p>Classical hypothesis testing employs the <em>p</em>-value to
determine whether to reject the null hypothesis of material misstatement
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>.
For instance, let’s assume an auditor aims to confirm if the population
contains less than five percent misstatement. This suggests the
hypotheses
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>&lt;</mo></mrow><annotation encoding="application/x-tex">\theta &lt;</annotation></semantics></math>
0.05 and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>≥</mo></mrow><annotation encoding="application/x-tex">\theta \geq</annotation></semantics></math>
0.05. The auditor selects a sample of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
= 100 items, with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
= 1 item containing a misstatement. They establish the significance
level for the <em>p</em>-value (i.e., the sampling risk) at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
= 0.05, indicating that a <em>p</em>-value below 0.05 will suffice to
reject the null hypothesis. The following command evaluates the sample
using a classical non-stratified evaluation method <span class="citation">(Stewart, 2012)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  1 and 100</span></span>
<span><span class="co">## number of errors = 1, number of samples = 100, taint = 1, p-value =</span></span>
<span><span class="co">## 0.040428</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.05</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.00000000 0.04743865</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.01 </span></span>
<span><span class="co">## results obtained via method 'poisson'</span></span></code></pre>
<p>The output indicates that the most likely misstatement in the
population is estimated to be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mi>k</mi><mi>n</mi></mfrac><annotation encoding="application/x-tex">\frac{k}{n}</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mn>100</mn></mfrac><annotation encoding="application/x-tex">\frac{1}{100}</annotation></semantics></math>
= 0.01, or 1 percent, and the 95 percent (one-sided) confidence interval
spans from 0 percent to 4.74 percent. It also reveals that the
<em>p</em>-value is below 0.05, suggesting that the null hypothesis
should be rejected. Consequently, the auditor can infer that the sample
provides sufficient evidence to conclude with a reasonable degree of
certainty that the population does not contain material
misstatement.</p>
</div>
<div class="section level4">
<h4 id="bayesian-approach">Bayesian approach<a class="anchor" aria-label="anchor" href="#bayesian-approach"></a>
</h4>
<p>Bayesian hypothesis testing employs the Bayes factor, either
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>F</mi><mn>10</mn></msub></mrow><annotation encoding="application/x-tex">BF_{10}</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>F</mi><mn>01</mn></msub></mrow><annotation encoding="application/x-tex">BF_{01}</annotation></semantics></math>,
to quantify the evidence that the sample provides in support of either
of the two hypotheses
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math><span class="citation">(Derks et al., 2024)</span>. For instance, a
Bayes factor value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>F</mi><mn>10</mn></msub></mrow><annotation encoding="application/x-tex">BF_{10}</annotation></semantics></math>
= 10 (provided by the <code><a href="../reference/evaluation.html">evaluation()</a></code> function) can be
interpreted as the data being 10 times more likely under the hypothesis
of tolerable misstatement
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>
than under the hypothesis of material misstatement
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>.
A value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>F</mi><mn>10</mn></msub><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">BF_{10} &gt;</annotation></semantics></math>
1 indicates evidence in favor of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>
and opposing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>,
while a value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>F</mi><mn>10</mn></msub><mo>&lt;</mo></mrow><annotation encoding="application/x-tex">BF_{10} &lt;</annotation></semantics></math>
1 indicates evidence supporting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
and contradicting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>.
The <code><a href="../reference/evaluation.html">evaluation()</a></code> function returns the value for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>F</mi><mn>10</mn></msub></mrow><annotation encoding="application/x-tex">BF_{10}</annotation></semantics></math>,
but
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>F</mi><mn>01</mn></msub></mrow><annotation encoding="application/x-tex">BF_{01}</annotation></semantics></math>
can be calculated as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mrow><mi>B</mi><msub><mi>F</mi><mn>10</mn></msub></mrow></mfrac><annotation encoding="application/x-tex">\frac{1}{BF_{10}}</annotation></semantics></math>.</p>
<p>Consider the earlier example where an auditor wishes to confirm if
the population contains less than five percent misstatement, suggesting
the hypotheses
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>&lt;</mo></mrow><annotation encoding="application/x-tex">\theta &lt;</annotation></semantics></math>
0.05 and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>≥</mo></mrow><annotation encoding="application/x-tex">\theta \geq</annotation></semantics></math>
0.05. They have selected a sample of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
= 100 items, with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
= 1 item found to contain a misstatement. The prior distribution is
presumed to be a default beta(1,1) prior. The subsequent call evaluates
the sample using a Bayesian non-stratified evaluation procedure <span class="citation">(Derks et al., 2021; Stewart, 2013)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">100</span>, method <span class="op">=</span> <span class="st">"binomial"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  1 and 100</span></span>
<span><span class="co">## number of errors = 1, number of samples = 100, taint = 1, BF₁₀ = 515.86</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.05</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.00000000 0.04610735</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.01 </span></span>
<span><span class="co">## results obtained via method 'binomial' + 'prior'</span></span></code></pre>
<p>The output indicates that the most likely misstatement in the
population is estimated to be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mi>k</mi><mi>n</mi></mfrac><annotation encoding="application/x-tex">\frac{k}{n}</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mn>100</mn></mfrac><annotation encoding="application/x-tex">\frac{1}{100}</annotation></semantics></math>
= 0.01, or 1 percent, and the 95 percent (one-sided) credible interval
spans from 0 percent to 4.61 percent. The minor discrepancy between the
classical and default Bayesian results in the upper limit can be
attributed to the prior distribution, which needs to be proper for the
calculation of a Bayes factor. Classical results can be replicated by
formulating an improper prior distribution using
<code>method = "strict"</code> in the <code><a href="../reference/auditPrior.html">auditPrior()</a></code>
function. The Bayes factor in this scenario is demonstrated to be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>F</mi><mn>10</mn></msub></mrow><annotation encoding="application/x-tex">BF_{10}</annotation></semantics></math>
= 515, signifying that the sample data are approximately 515 times more
likely to occur under the hypothesis of tolerable misstatement than
under the hypothesis of material misstatement.</p>
<p>It is important to note that this is a considerably high Bayes factor
given the small amount of data observed. This can be explained by the
fact that the Bayes factor is influenced by the prior distribution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.
The default prior distribution is <strong>not</strong> a good prior for
hypothesis testing. As a general guideline, when the prior distribution
is extremely conservative in relation to the hypothesis of tolerable
misstatement (as with <code>method = 'default'</code>), the Bayes factor
tends to overstate the evidence supporting this hypothesis. This
dependency can be alleviated by employing a prior distribution that is
impartial towards the hypotheses <span class="citation">(Derks et al.,
2022a)</span>, which can be achieved using
<code>method = "impartial"</code> in the <code><a href="../reference/auditPrior.html">auditPrior()</a></code>
function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auditPrior.html">auditPrior</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"impartial"</span>, likelihood <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">100</span>, prior <span class="op">=</span> <span class="va">prior</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  1 and 100</span></span>
<span><span class="co">## number of errors = 1, number of samples = 100, taint = 1, BF₁₀ = 47.435</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.05</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.00000000 0.04110834</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.0088878 </span></span>
<span><span class="co">## results obtained via method 'binomial' + 'prior'</span></span></code></pre>
<p>The output reveals that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>F</mi><mn>10</mn></msub></mrow><annotation encoding="application/x-tex">BF_{10}</annotation></semantics></math>
= 47, suggesting that under the presumption of impartiality, there is
substantial evidence for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>,
the hypothesis that the population contains misstatements less than five
percent of the population (tolerable misstatement). Given that both
prior distributions resulted in persuasive Bayes factors, the results
can be deemed robust to the selection of prior distribution.
Consequently, the auditor can deduce that the sample provides compelling
evidence to conclude that the population does not contain material
misstatement.</p>
</div>
</div>
<div class="section level3">
<h3 id="stratified-samples">Stratified samples<a class="anchor" aria-label="anchor" href="#stratified-samples"></a>
</h3>
<p>In a stratified sampling method, the auditor extracts samples from
various subgroups, or strata, within a population. This could be
applicable in a group audit scenario where the audited organization
comprises different components or branches. Stratification becomes
pertinent for the group auditor when they need to form an opinion on the
group as a whole, as they are required to consolidate the samples taken
by the component auditors.</p>
<p>For instance, consider the <code>retailer</code> data set included in
the package. The organization in question has twenty branches spread
across the country. In each of the twenty strata, a component auditor
has conducted a statistical sample and reported the results to the group
auditor.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"retailer"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">retailer</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    stratum items samples errors</span></span>
<span><span class="co">## 1        1  5000     300     21</span></span>
<span><span class="co">## 2        2  5000     300     16</span></span>
<span><span class="co">## 3        3  5000     300     15</span></span>
<span><span class="co">## 4        4  5000     300     14</span></span>
<span><span class="co">## 5        5  5000     300     16</span></span>
<span><span class="co">## 6        6  5000     150      5</span></span>
<span><span class="co">## 7        7  5000     150      4</span></span>
<span><span class="co">## 8        8  5000     150      3</span></span>
<span><span class="co">## 9        9  5000     150      4</span></span>
<span><span class="co">## 10      10  5000     150      5</span></span>
<span><span class="co">## 11      11 10000      50      2</span></span>
<span><span class="co">## 12      12 10000      50      3</span></span>
<span><span class="co">## 13      13 10000      50      2</span></span>
<span><span class="co">## 14      14 10000      50      1</span></span>
<span><span class="co">## 15      15 10000      50      0</span></span>
<span><span class="co">## 16      16 10000      15      0</span></span>
<span><span class="co">## 17      17 10000      15      0</span></span>
<span><span class="co">## 18      18 10000      15      0</span></span>
<span><span class="co">## 19      19 10000      15      1</span></span>
<span><span class="co">## 20      20  4000      15      3</span></span></code></pre>
<p>Generally, there are two methodologies for evaluating a stratified
sample: no pooling and partial pooling <span class="citation">(see Derks
et al., 2022b)</span>. When using the <code><a href="../reference/evaluation.html">evaluation()</a></code> function
in a stratified sampling context, you need to specify the type of
pooling to be used via its <code>pooling</code> argument. No pooling
presumes no similarities between strata, implying that all strata are
analyzed independently. Partial pooling presumes both differences and
similarities between strata, implying that information can be shared
between strata. This technique is also known as multilevel or
hierarchical modeling and can lead to more efficient population and
stratum estimates. However, it is currently only available in
<strong>jfa</strong> when conducting a Bayesian analysis. For this
reason, this vignette primarily describes the Bayesian approach to
evaluating stratified audit samples. However, transitioning from a
Bayesian approach to a classical approach only requires setting
<code>prior = FALSE</code>.</p>
<p>The number of units (this can be items or monetary units depending on
the audit objective) per stratum in the population can be supplied with
<code>N.units</code> to weigh the stratum estimates for determining the
population estimate. This process is known as poststratification. If
<code>N.units</code> is not specified, it is assumed that each stratum
is equally represented in the population.</p>
<div class="section level4">
<h4 id="approach-1-no-pooling">Approach 1: No pooling<a class="anchor" aria-label="anchor" href="#approach-1-no-pooling"></a>
</h4>
<p>The no pooling approach (<code>pooling = "none"</code>) is the
default option and assumes there are no similarities between strata.
This implies that the prior distribution, specified through
<code>prior</code>, is applied independently in each stratum. This
approach allows for independent estimates of the misstatement in each
stratum, but for this reason it also results in a relatively high
uncertainty in the population estimate. The following command evaluates
the sample using a Bayesian stratified evaluation procedure, where the
stratum estimates are poststratified to derive the population estimate.
Note that it is important to set the seed via <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>
because the posterior distribution is determined via sampling.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result_np</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  n <span class="op">=</span> <span class="va">retailer</span><span class="op">[[</span><span class="st">"samples"</span><span class="op">]</span><span class="op">]</span>, x <span class="op">=</span> <span class="va">retailer</span><span class="op">[[</span><span class="st">"errors"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  N.units <span class="op">=</span> <span class="va">retailer</span><span class="op">[[</span><span class="st">"items"</span><span class="op">]</span><span class="op">]</span>, pooling <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_np</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Population size:                144000 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ = 0.05 vs. H₁: Θ ≠ 0.05 </span></span>
<span><span class="co">##   Method:                         binomial </span></span>
<span><span class="co">##   Prior distribution:             Nonparametric </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    2575 </span></span>
<span><span class="co">##   Number of errors:               115 </span></span>
<span><span class="co">##   Sum of taints:                  115 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         Nonparametric </span></span>
<span><span class="co">##   Most likely error:              0.0598 </span></span>
<span><span class="co">##   95 percent credible interval:   [0.042763, 0.082201] </span></span>
<span><span class="co">##   Precision:                      0.022401 </span></span>
<span><span class="co">##   BF₁₀:                            0 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata (20):</span></span>
<span><span class="co">##          N   n  x  t     mle      lb      ub precision</span></span>
<span><span class="co">##   1   5000 300 21 21 0.07000 0.04637 0.10467   0.03467</span></span>
<span><span class="co">##   2   5000 300 16 16 0.05333 0.03324 0.08489   0.03156</span></span>
<span><span class="co">##   3   5000 300 15 15 0.05000 0.03069 0.08086   0.03086</span></span>
<span><span class="co">##   4   5000 300 14 14 0.04667 0.02816 0.07681   0.03014</span></span>
<span><span class="co">##   5   5000 300 16 16 0.05333 0.03324 0.08489   0.03156</span></span>
<span><span class="co">##   6   5000 150  5  5 0.03333 0.01472 0.07558   0.04225</span></span>
<span><span class="co">##   7   5000 150  4  4 0.02667 0.01084 0.06643   0.03977</span></span>
<span><span class="co">##   8   5000 150  3  3 0.02000 0.00726 0.05696   0.03696</span></span>
<span><span class="co">##   9   5000 150  4  4 0.02667 0.01084 0.06643   0.03977</span></span>
<span><span class="co">##   10  5000 150  5  5 0.03333 0.01472 0.07558   0.04225</span></span>
<span><span class="co">##   11 10000  50  2  2 0.04000 0.01230 0.13459   0.09459</span></span>
<span><span class="co">##   12 10000  50  3  3 0.06000 0.02178 0.16242   0.10242</span></span>
<span><span class="co">##   13 10000  50  2  2 0.04000 0.01230 0.13459   0.09459</span></span>
<span><span class="co">##   14 10000  50  1  1 0.02000 0.00478 0.10447   0.08447</span></span>
<span><span class="co">##   15 10000  50  0  0 0.00000 0.00050 0.06978   0.06978</span></span>
<span><span class="co">##   16 10000  15  0  0 0.00000 0.00158 0.20591   0.20591</span></span>
<span><span class="co">##   17 10000  15  0  0 0.00000 0.00158 0.20591   0.20591</span></span>
<span><span class="co">##   18 10000  15  0  0 0.00000 0.00158 0.20591   0.20591</span></span>
<span><span class="co">##   19 10000  15  1  1 0.06667 0.01551 0.30232   0.23565</span></span>
<span><span class="co">##   20  4000  15  3  3 0.20000 0.07266 0.45646   0.25646</span></span></code></pre>
<p>In this scenario, the output of the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function
indicates that the estimated misstatement in the population is 5.98
percent, with the 95 percent (two-sided) credible interval extending
from 4.28 percent to 8.22 percent. The estimates for each stratum vary
significantly from one another but exhibit relative uncertainty. They
can be visualized via the call below to
<code>plot(..., type = "estimates")</code></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_np</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The prior and posterior distribution for the population misstatement
can be obtained using the <code>plot(..., type = "posterior")</code>
function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_np</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="approach-2-partial-pooling">Approach 2: Partial pooling<a class="anchor" aria-label="anchor" href="#approach-2-partial-pooling"></a>
</h4>
<p>The partial pooling approach (<code>pooling = "partial"</code>)
presumes both differences and similarities between strata. This enables
the auditor to share information among the strata to minimize
uncertainty in the population estimate. The following call evaluates the
sample using a Bayesian stratified evaluation procedure, where the
stratum estimates are poststratified to derive the population estimate.
Remember, it is important to set the seed via <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> to
make the results reproducible.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result_pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  n <span class="op">=</span> <span class="va">retailer</span><span class="op">[[</span><span class="st">"samples"</span><span class="op">]</span><span class="op">]</span>, x <span class="op">=</span> <span class="va">retailer</span><span class="op">[[</span><span class="st">"errors"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  N.units <span class="op">=</span> <span class="va">retailer</span><span class="op">[[</span><span class="st">"items"</span><span class="op">]</span><span class="op">]</span>, pooling <span class="op">=</span> <span class="st">"partial"</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_pp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Population size:                144000 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ = 0.05 vs. H₁: Θ ≠ 0.05 </span></span>
<span><span class="co">##   Method:                         binomial </span></span>
<span><span class="co">##   Prior distribution:             Nonparametric </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    2575 </span></span>
<span><span class="co">##   Number of errors:               115 </span></span>
<span><span class="co">##   Sum of taints:                  115 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         Nonparametric </span></span>
<span><span class="co">##   Most likely error:              0.0423 </span></span>
<span><span class="co">##   95 percent credible interval:   [0.032494, 0.053654] </span></span>
<span><span class="co">##   Precision:                      0.011354 </span></span>
<span><span class="co">##   BF₁₀:                            0.030086 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata (20):</span></span>
<span><span class="co">##          N   n  x  t    mle      lb      ub precision</span></span>
<span><span class="co">##   1   5000 300 21 21 0.0579 0.04003 0.08836   0.03046</span></span>
<span><span class="co">##   2   5000 300 16 16 0.0503 0.03217 0.07359   0.02329</span></span>
<span><span class="co">##   3   5000 300 15 15 0.0424 0.03042 0.07060   0.02820</span></span>
<span><span class="co">##   4   5000 300 14 14 0.0425 0.02849 0.06764   0.02514</span></span>
<span><span class="co">##   5   5000 300 16 16 0.0437 0.03195 0.07382   0.03012</span></span>
<span><span class="co">##   6   5000 150  5  5 0.0378 0.01823 0.06365   0.02585</span></span>
<span><span class="co">##   7   5000 150  4  4 0.0360 0.01511 0.05944   0.02344</span></span>
<span><span class="co">##   8   5000 150  3  3 0.0341 0.01177 0.05539   0.02129</span></span>
<span><span class="co">##   9   5000 150  4  4 0.0364 0.01474 0.05940   0.02300</span></span>
<span><span class="co">##   10  5000 150  5  5 0.0357 0.01783 0.06357   0.02787</span></span>
<span><span class="co">##   11 10000  50  2  2 0.0433 0.01658 0.08010   0.03680</span></span>
<span><span class="co">##   12 10000  50  3  3 0.0431 0.02147 0.09121   0.04811</span></span>
<span><span class="co">##   13 10000  50  2  2 0.0373 0.01676 0.07932   0.04202</span></span>
<span><span class="co">##   14 10000  50  1  1 0.0356 0.01120 0.07089   0.03529</span></span>
<span><span class="co">##   15 10000  50  0  0 0.0392 0.00548 0.06181   0.02261</span></span>
<span><span class="co">##   16 10000  15  0  0 0.0364 0.00895 0.08006   0.04366</span></span>
<span><span class="co">##   17 10000  15  0  0 0.0374 0.00861 0.07943   0.04203</span></span>
<span><span class="co">##   18 10000  15  0  0 0.0387 0.00867 0.08028   0.04158</span></span>
<span><span class="co">##   19 10000  15  1  1 0.0403 0.01598 0.09819   0.05789</span></span>
<span><span class="co">##   20  4000  15  3  3 0.0472 0.02772 0.13675   0.08955</span></span></code></pre>
<p>In this scenario, the output indicates that the estimated
misstatement in the population is 4.23 percent, with the 95 percent
credible interval extending from 3.25 percent to 5.37 percent. Note that
this population estimate is considerably less uncertain compared to the
no pooling approach. Similarly to the no pooling approach, the stratum
estimates differ from each other but are closer together and exhibit
less uncertainty. This can be explained by the fact that the partial
pooling approach allows for information to be shared between strata. The
stratum estimates can be visualized via a call to
<code>plot(..., type = "estimates")</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_pp</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The prior and posterior distribution for the population misstatement
can be obtained using the <code>plot(..., type = "posterior")</code>
function.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_pp</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-12-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="evaluation-using-data">Evaluation using data<a class="anchor" aria-label="anchor" href="#evaluation-using-data"></a>
</h2>
<p>In this example, we will demonstrate how to evaluate a stratified
sample using a data set. We will use the <code>allowances</code> data
set that is included in the package. This data set comprises
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
= 3500 subsidy declarations from municipalities. Each line item has a
recorded value book value (column <code>bookValue</code>) and an audited
value (column <code>auditValue</code>), which is the true value for the
purpose of this illustration. The data set already identifies the items
that have been audited as part of the sample in the column
<code>times</code>. In this scenario, we will be performing estimation
and therefore do not specify the <code>materiality</code> argument in
the <code><a href="../reference/evaluation.html">evaluation()</a></code> function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"allowances"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">allowances</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   item branch bookValue auditValue times</span></span>
<span><span class="co">## 1    1     12      1600       1600     1</span></span>
<span><span class="co">## 2    2     12      1625         NA     0</span></span>
<span><span class="co">## 3    3     12      1775         NA     0</span></span>
<span><span class="co">## 4    4     12      1250       1250     1</span></span>
<span><span class="co">## 5    5     12      1400         NA     0</span></span>
<span><span class="co">## 6    6     12      1190         NA     0</span></span></code></pre>
<div class="section level3">
<h3 id="non-stratified-samples-1">Non-stratified samples<a class="anchor" aria-label="anchor" href="#non-stratified-samples-1"></a>
</h3>
<p>To evaluate a non-stratified sample using data, you need to specify
the <code>data</code>, <code>values</code>, and
<code>values.audit</code> arguments. The input for these arguments
should be the name of the corresponding column in the input for the
<code>data</code> argument.</p>
<div class="section level4">
<h4 id="classical-approach-1">Classical approach<a class="anchor" aria-label="anchor" href="#classical-approach-1"></a>
</h4>
<p>The command below evaluates the <code>allowances</code> sample using
a classical non-stratified evaluation approach. Note that the sample is
automatically separated from the population because the
<code>times</code> value for items not in the sample is
<code>0</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">allowances</span>, times <span class="op">=</span> <span class="st">"times"</span>, method <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  allowances</span></span>
<span><span class="co">## number of errors = 401, number of samples = 1604, taint = 252.93</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.0000000 0.1734283</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.15769 </span></span>
<span><span class="co">## results obtained via method 'binomial'</span></span></code></pre>
<p>In this instance, the output indicates that the estimated
misstatement in the population is 15.77 percent. The 95 percent
(one-sided) confidence interval extends from 0 percent to 17.34 percent.
More detailed information can be obtained via the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
function.</p>
</div>
<div class="section level4">
<h4 id="bayesian-approach-1">Bayesian approach<a class="anchor" aria-label="anchor" href="#bayesian-approach-1"></a>
</h4>
<p>The call below evaluates the <code>allowances</code> sample using a
Bayesian non-stratified evaluation procedure. The performance
materiality for this example is set to twenty percen of the population
value.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.2</span>, data <span class="op">=</span> <span class="va">allowances</span>, times <span class="op">=</span> <span class="st">"times"</span>, method <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  allowances</span></span>
<span><span class="co">## number of errors = 401, number of samples = 1604, taint = 252.93, BF₁₀</span></span>
<span><span class="co">## = 545408</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.2</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.0000000 0.1733213</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.15769 </span></span>
<span><span class="co">## results obtained via method 'binomial' + 'prior'</span></span></code></pre>
<p>The output shows that the estimate of the misstatement in the
population is 15.77 percent, with the 95 percent (one-sided) credible
interval ranging from 0 percent to 17.33 percent. More detailed
information can be obtained via <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> and the prior and
posterior distribution can be obtained by a call to
<code>plot(..., type = "posterior")</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-16-1.png" width="576" style="display: block; margin: auto;"></p>
<p>It is also possible to see how the Bayes factor evolves as a function
of the sample size. This can be done using
<code>plot(..., type = "sequential")</code>. In this case, the Bayes
factor is very large due to the large sample.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, type <span class="op">=</span> <span class="st">"sequential"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-17-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="stratified-samples-1">Stratified samples<a class="anchor" aria-label="anchor" href="#stratified-samples-1"></a>
</h3>
<p>To evaluate a stratified sample using a data set, you need to specify
the <code>data</code>, <code>values</code>, <code>values.audit</code>,
and <code>strata</code> arguments in the <code><a href="../reference/evaluation.html">evaluation()</a></code>
function. The input for <code>N.units</code> is once again optional. In
this example, the units are monetary, determined by summing up the book
values of the items within each stratum. For instance, we can see that
stratum two is the largest, with a total value of $2,792,814.33 and
stratum five is the smallest, with a total value of $96,660.53.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N.units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">allowances</span><span class="op">$</span><span class="va">bookValue</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">allowances</span><span class="op">$</span><span class="va">branch</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">N.units</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       N.units</span></span>
<span><span class="co">## 1   317200.09</span></span>
<span><span class="co">## 2  2792814.33</span></span>
<span><span class="co">## 3  1144231.69</span></span>
<span><span class="co">## 4   414202.89</span></span>
<span><span class="co">## 5    96660.53</span></span>
<span><span class="co">## 6   348006.13</span></span>
<span><span class="co">## 7  2384079.33</span></span>
<span><span class="co">## 8  1840399.33</span></span>
<span><span class="co">## 9   563957.70</span></span>
<span><span class="co">## 10 3198877.73</span></span>
<span><span class="co">## 11 1983299.06</span></span>
<span><span class="co">## 12  319144.13</span></span>
<span><span class="co">## 13  148905.79</span></span>
<span><span class="co">## 14  513058.76</span></span>
<span><span class="co">## 15  432007.61</span></span>
<span><span class="co">## 16  275403.70</span></span></code></pre>
<div class="section level4">
<h4 id="classical-approach-2">Classical approach<a class="anchor" aria-label="anchor" href="#classical-approach-2"></a>
</h4>
<p>The following command evaluates the <code>allowances</code> sample
using a classical stratified evaluation method. In this process, the
estimates from each stratum are poststratified to derive the estimate
for the entire population. Note that for computational reasons it is
important to set a seed here via <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">allowances</span>, times <span class="op">=</span> <span class="st">"times"</span>, method <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>,</span>
<span>  N.units <span class="op">=</span> <span class="va">N.units</span>, strata <span class="op">=</span> <span class="st">"branch"</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  allowances</span></span>
<span><span class="co">## number of errors = 401, number of samples = 1604, taint = 252.93</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.1298437 0.1759994</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.14723 </span></span>
<span><span class="co">## results obtained via method 'binomial' + 'no-pooling'</span></span></code></pre>
<p>In this instance, the output reveals that the estimated misstatement
in the population is 14.72 percent. The 95 percent confidence interval
spans from 12.98 percent to 17.6 percent. The precision of the
population estimate is therefore 4.26 percent. The estimates for each
stratum are visualized below. For more detailed information, including
the actual stratum estimates, you can use the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
function.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-20-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="bayesian-approach-2">Bayesian approach<a class="anchor" aria-label="anchor" href="#bayesian-approach-2"></a>
</h4>
<p>Bayesian inference can enhance the estimates obtained from the
classical approach by pooling information across strata where feasible.
The following command evaluates the <code>allowances</code> sample using
a Bayesian stratified evaluation method. In this process, the estimates
from each stratum are pooled and poststratified to derive the estimate
for the entire population.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">allowances</span>, times <span class="op">=</span> <span class="st">"times"</span>, method <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>,</span>
<span>  N.units <span class="op">=</span> <span class="va">N.units</span>, strata <span class="op">=</span> <span class="st">"branch"</span>, pooling <span class="op">=</span> <span class="st">"partial"</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>  prior <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  allowances</span></span>
<span><span class="co">## number of errors = 401, number of samples = 1350, taint = 224.66</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.1571337 0.1757009</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.1659 </span></span>
<span><span class="co">## results obtained via method 'binomial' + 'partial-pooling' + 'prior'</span></span></code></pre>
<p>The output indicates that the estimated misstatement in the
population is 16.59 percent. The 95 percent credible interval spans from
15.71 percent to 17.57 percent. The precision of the population estimate
is therefore 1.86 percent, which is lower than that of the classical
approach. The estimates for each stratum are visualized below using the
<code>plot(..., type = "estimates)</code> command but their actual
values can be once again be obtained using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
function.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-23-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The prior and posterior distribution for the population misstatement
can be obtained via the <code>plot(..., type = "posterior")</code>
function.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-24-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-derks_2021" class="csl-entry">
Derks, K., Swart, J. de, Batenburg, P. van, Wagenmakers, E.-J., &amp;
Wetzels, R. (2021). Priors in a <span>B</span>ayesian audit: How
integration of existing information into the prior distribution can
improve audit transparency and efficiency. <em>International Journal of
Auditing</em>, <em>25</em>(3), 621–636. <a href="https://doi.org/10.1111/ijau.12240" class="external-link">https://doi.org/10.1111/ijau.12240</a>
</div>
<div id="ref-derks_2022" class="csl-entry">
Derks, K., Swart, J. de, Wagenmakers, E.-J., &amp; Wetzels, R. (2022a).
<em>An impartial <span>B</span>ayesian hypothesis test for audit
sampling</em>. <a href="https://doi.org/10.31234/osf.io/8nf3e" class="external-link">https://doi.org/10.31234/osf.io/8nf3e</a>
</div>
<div id="ref-derks_2022b" class="csl-entry">
Derks, K., Swart, J. de, Wagenmakers, E.-J., &amp; Wetzels, R. (2022b).
Bayesian generalized linear modeling for audit sampling: How to
incorporate audit information into the statistical model.
<em>PsyArXiv</em>. <a href="https://doi.org/10.31234/osf.io/byj2a" class="external-link">https://doi.org/10.31234/osf.io/byj2a</a>
</div>
<div id="ref-derks_2021b" class="csl-entry">
Derks, K., Swart, J. de, Wagenmakers, E.-J., &amp; Wetzels, R. (2024).
The <span>B</span>ayesian approach to audit evidence: Quantifying
statistical evidence using the bayes factor. <em>Auditing: A Journal of
Practice &amp; Theory</em>. <a href="https://doi.org/10.31234/osf.io/kzqp5" class="external-link">https://doi.org/10.31234/osf.io/kzqp5</a>
</div>
<div id="ref-stewart_2012" class="csl-entry">
Stewart, T. R. (2012). <em>Technical notes on the <span>AICPA</span>
audit guide audit sampling</em>. American Institute of Certified Public
Accountants.
</div>
<div id="ref-stewart_2013" class="csl-entry">
Stewart, T. R. (2013). <em>A <span>B</span>ayesian audit assurance model
with application to the component materiality problem in group
audits</em> [PhD thesis, VU University]. <a href="https://hdl.handle.net/1871/39813" class="external-link">https://hdl.handle.net/1871/39813</a>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://koenderks.com" class="external-link">Koen Derks</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
