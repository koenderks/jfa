<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evaluating statistical audit samples • jfa</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Evaluating statistical audit samples">
<meta property="og:description" content="jfa">
<meta property="og:image" content="https://koenderks.github.io/jfa/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/jfa.html">Get started</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/koenderks/jfa" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/koenderks/jfa/discussions" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Evaluating statistical audit samples</h1>
                        <h4 data-toc-skip class="author">Koen Derks</h4>
            
            <h4 data-toc-skip class="date">2022-12-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/koenderks/jfa/blob/HEAD/vignettes/sample-evaluation.Rmd" class="external-link"><code>vignettes/sample-evaluation.Rmd</code></a></small>
      <div class="hidden name"><code>sample-evaluation.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p align="center">
<img src="https://github.com/koenderks/jfa/raw/development/vignettes/img/evaluation.png" alt="evaluation" width="100%"></p>
<p>This vignette demonstrates how to evaluate a sample with the
<code><a href="../reference/evaluation.html">evaluation()</a></code> function from the <strong>jfa</strong>
package. In auditing, the goal of the evaluation is typically to
estimate the misstatement in the population based on a sample, or to
test the misstatement in the population against a critical upper limit,
referred to as the performance materiality. Evaluating an audit sample
using the <code><a href="../reference/evaluation.html">evaluation()</a></code> function requires that the sample
data is available in one of two forms:</p>
<ul>
<li>
<strong>Summary statistics:</strong> This includes (a vector of) the
number of items (<code>n</code>), (a vector of) the sum of errors /
taints (<code>x</code>) and optionally (a vector of) the number of units
in the population (<code>N.units</code>).</li>
<li>
<strong>Data:</strong> A <code>data.frame</code> containing a
numeric column with book values (<code>values</code>), a numeric column
with audit (true) values (<code>values.audit</code>) and optionally a
factor column indicating stratum membership (<code>strata</code>).</li>
</ul>
<p>By default, <code><a href="../reference/evaluation.html">evaluation()</a></code> estimates the population
misstatement and returns a point estimate as well as a
(<code>conf.level</code> <span class="math inline">\(times\)</span>
100)% confidence / credible interval around this estimate. However, in
audit sampling, the population is typically subject to a certain maximum
tolerable misstatement defined by the performance materiality <span class="math inline">\(theta_max\)</span>. Using the
<code>materiality</code> argument, you can provide this critical value
to the <code><a href="../reference/evaluation.html">evaluation()</a></code> function as a fraction. In addition to
the estimation that is performed by default, specifying
<code>materiality</code> triggers the comparison of two competing
hypotheses. Which hypotheses are being compared depends on the input for
the <code>alternative</code> argument:</p>
<ul>
<li>
<code>alternative = "less"</code> (default): <span class="math inline">\(H_1:\theta&lt;\theta_{max}\)</span> versus <span class="math inline">\(H_0:\theta\geq\theta_{max}\)</span>
</li>
<li>
<code>alternative = "greater"</code>: <span class="math inline">\(H_1:\theta&gt;\theta_{max}\)</span> versus <span class="math inline">\(H_0:\theta\leq\theta_{max}\)</span>
</li>
<li>
<code>alternative = "two.sided"</code>: <span class="math inline">\(H_1:\theta \neq\theta_{max}\)</span> versus <span class="math inline">\(H_0:\theta=\theta_{max}\)</span>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="evaluation-using-summary-statistics">Evaluation using summary statistics<a class="anchor" aria-label="anchor" href="#evaluation-using-summary-statistics"></a>
</h2>
<div class="section level3">
<h3 id="non-stratified-samples">Non-stratified samples<a class="anchor" aria-label="anchor" href="#non-stratified-samples"></a>
</h3>
<p>In a non-stratified sampling procedure, the auditor does not take
samples from different strata or subgroups in a population. An example
of such a situation would be where the auditor is auditing the general
ledger of a small business.</p>
<div class="section level4">
<h4 id="classical-evaluation">Classical evaluation<a class="anchor" aria-label="anchor" href="#classical-evaluation"></a>
</h4>
<p>Classical hypothesis testing uses the <em>p</em>-value to make a
decision about whether to reject the hypothesis <span class="math inline">\(H_0\)</span> or not. As an example, consider that
an auditor wants to verify whether the population contains less than 5
percent misstatement, implying the hypotheses <span class="math inline">\(H_1:\theta&lt;0.05\)</span> and <span class="math inline">\(H_0:\theta\geq0.05\)</span>. They have taken a
sample of 100 items, of which 1 contained an error. They set the
significance level for the <em>p</em>-value to 0.05, implying that <span class="math inline">\(p &lt; 0.05\)</span> will be enough to reject the
hypothesis <span class="math inline">\(H_0\)</span>. The call below
evaluates the sample using a classical non-stratified evaluation
procedure.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  1 and 100</span></span>
<span><span class="co">## number of errors = 1, number of samples = 100, taint = 1, p-value =</span></span>
<span><span class="co">## 0.040428</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.05</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.00000000 0.04743865</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.01 </span></span>
<span><span class="co">## results obtained via method 'poisson'</span></span></code></pre>
<p>The output shows that the most likely error in the population is
estimated to be 1 / 100 = 1% and that the 95% (one-sided) confidence
interval ranges from 0% to 4.74%. The output also shows that the
<em>p</em>-value is lower than 0.05 implying that the hypothesis <span class="math inline">\(H_0\)</span> can be rejected. Hence, the auditor
is able to conclude that the sample provides sufficient evidence to
state with reasonable assurance that the population does not contain
material misstatement.</p>
</div>
<div class="section level4">
<h4 id="bayesian-evaluation">Bayesian evaluation<a class="anchor" aria-label="anchor" href="#bayesian-evaluation"></a>
</h4>
<p>Bayesian hypothesis testing uses the Bayes factor, <span class="math inline">\(BF_{10}\)</span> or <span class="math inline">\(BF_{01}\)</span>, to make a statement about the
evidence provided by the sample in support for one of the two hypotheses
<span class="math inline">\(H_1\)</span> or <span class="math inline">\(H_0\)</span>. As an example of how to interpret
the Bayes factor, the value of <span class="math inline">\(BF_{10} =
10\)</span> (provided by the <code><a href="../reference/evaluation.html">evaluation()</a></code> function) can be
interpreted as: <em>the data are 10 times more likely to have occurred
under the hypothesis <span class="math inline">\(H_1\)</span> than under
the hypothesis <span class="math inline">\(H_0\)</span></em>. <span class="math inline">\(BF_{10} &gt; 1\)</span> indicates evidence in
favor of <span class="math inline">\(H_1\)</span> and against <span class="math inline">\(H_0\)</span>, while <span class="math inline">\(BF_{10} &lt; 1\)</span> indicates evidence in
favor of <span class="math inline">\(H_0\)</span> and against <span class="math inline">\(H_1\)</span>. By default, the
<code><a href="../reference/evaluation.html">evaluation()</a></code> function returns the value for <span class="math inline">\(BF_{10}\)</span>.</p>
<p>Consider the previous example of an auditor who wants to verify
whether the population contains less than 5 percent misstatement,
implying the hypotheses <span class="math inline">\(H_1:\theta&lt;0.05\)</span> and <span class="math inline">\(H_0:\theta\geq0.05\)</span>. They have taken a
sample of 100 items, of which 1 was found to contain a misstatement. The
prior distribution is assumed to be a default <em>beta(1,1)</em> prior.
The call below evaluates the sample using a Bayesian non-stratified
evaluation procedure.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auditPrior.html">auditPrior</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"default"</span>, likelihood <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">100</span>, prior <span class="op">=</span> <span class="va">prior</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using 'method = binomial' from 'prior'</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  1 and 100</span></span>
<span><span class="co">## number of errors = 1, number of samples = 100, taint = 1, BF₁₀ = 515.86</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.05</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.00000000 0.04610735</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.01 </span></span>
<span><span class="co">## results obtained via method 'binomial' + 'prior'</span></span></code></pre>
<p>The output shows that the most likely error in the population is
estimated to be 1 / 100 = 1% and that the 95% (one-sided) credible
interval ranges from 0% to 4.61%. The small difference between the
classical and default Bayesian results is due to the prior distribution,
which must be proper in order to calculate a Bayes factor (classical
results can be emulated by constructing a prior with
<code>method = "strict"</code> in the <code><a href="../reference/auditPrior.html">auditPrior()</a></code>
function). The Bayes factor in this case is shown to be <span class="math inline">\(BF_{10}=515\)</span>, meaning that the data from
the sample are about 515 times more likely to occur under the hypothesis
of tolerable misstatement than under the hypothesis of material
misstatement.</p>
<p>Note that this is a very high Bayes factor for the little data that
is observed. That is because the Bayes factor is dependent on the prior
distribution for <span class="math inline">\(\theta\)</span>. As a rule
of thumb, when the prior distribution is highly conservative (as with
<code>method = 'default'</code>) with respect to the hypothesis of
tolerable misstatement, the Bayes factor tends to over quantify the
evidence in favor of this hypothesis. You can mitigate this dependency
by using a prior distribution that is impartial with respect to the
hypotheses via <code>method = "impartial"</code> in the
<code><a href="../reference/auditPrior.html">auditPrior()</a></code> function (Derks et al., 2022).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auditPrior.html">auditPrior</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"impartial"</span>, likelihood <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">100</span>, prior <span class="op">=</span> <span class="va">prior</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using 'method = binomial' from 'prior'</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  1 and 100</span></span>
<span><span class="co">## number of errors = 1, number of samples = 100, taint = 1, BF₁₀ = 47.435</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.05</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.00000000 0.04110834</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.0088878 </span></span>
<span><span class="co">## results obtained via method 'binomial' + 'prior'</span></span></code></pre>
<p>The output shows that <span class="math inline">\(BF_{10}=47\)</span>, implying that under the
assumption of impartiality there is strong evidence for <span class="math inline">\(H_1\)</span>, the hypothesis that the population
contains misstatements lower than 5 percent of the population (tolerable
misstatement). Since the two prior distributions both resulted in
convincing Bayes factors, the results can be considered robust to the
choice of prior distribution. Hence, the auditor is able to conclude
that the sample provides convincing evidence to state that the
population does not contain material misstatement.</p>
</div>
</div>
<div class="section level3">
<h3 id="stratified-samples">Stratified samples<a class="anchor" aria-label="anchor" href="#stratified-samples"></a>
</h3>
<p>In a stratified sampling procedure, the auditor takes samples from
different strata or subgroups in a population. An example of such a
situation would be a group audit where the audited organization consists
of different components or branches. Stratification is relevant to the
group auditor if they must form an opinion on the group as a whole
because they must aggregate the samples taken by the component
auditors.</p>
<p>As a data example, consider the <code>retailer</code> data set that
comes with the package. The organization in question consists of 20
branches across the country. In each of the 20 strata, a component
auditor has taken a statistical sample and reported the outcomes to the
group auditor.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">retailer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">retailer</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    stratum items samples errors</span></span>
<span><span class="co">## 1        1  5000     300     21</span></span>
<span><span class="co">## 2        2  5000     300     16</span></span>
<span><span class="co">## 3        3  5000     300     15</span></span>
<span><span class="co">## 4        4  5000     300     14</span></span>
<span><span class="co">## 5        5  5000     300     16</span></span>
<span><span class="co">## 6        6  5000     150      5</span></span>
<span><span class="co">## 7        7  5000     150      4</span></span>
<span><span class="co">## 8        8  5000     150      3</span></span>
<span><span class="co">## 9        9  5000     150      4</span></span>
<span><span class="co">## 10      10  5000     150      5</span></span>
<span><span class="co">## 11      11 10000      50      2</span></span>
<span><span class="co">## 12      12 10000      50      3</span></span>
<span><span class="co">## 13      13 10000      50      2</span></span>
<span><span class="co">## 14      14 10000      50      1</span></span>
<span><span class="co">## 15      15 10000      50      0</span></span>
<span><span class="co">## 16      16 10000      15      0</span></span>
<span><span class="co">## 17      17 10000      15      0</span></span>
<span><span class="co">## 18      18 10000      15      0</span></span>
<span><span class="co">## 19      19 10000      15      1</span></span>
<span><span class="co">## 20      20  4000      15      3</span></span></code></pre>
<p>In general, there are three approaches to evaluating a stratified
sample: no pooling, complete pooling, and partial pooling (see Derks et
al., 2022). When using <code><a href="../reference/evaluation.html">evaluation()</a></code>, you must to indicate
which type of pooling to use via the <code>pooling</code> argument. No
pooling assumes no similarities between strata, which means that all
strata are analyzed independently. Complete pooling assumes no
difference between strata, which means that all data is aggregated and
analyzed as a whole. Finally, partial pooling assumes differences and
similarities between strata, which means that information can be shared
between strata. Partial pooling (i.e., multilevel/hierarchical modeling)
is a powerful technique that can result in more efficient population and
stratum estimates but is currently only feasible when performing a
Bayesian analysis. For this reason, this vignette only describes the
Bayesian approach to stratified evaluation but going from this approach
to a classical approach only requires setting
<code>prior = FALSE</code>.</p>
<p>The number of units per stratum in the population can be provided
with <code>N.units</code> to weigh the stratum estimates to determine
population estimate (i.e., poststratification).</p>
<div class="section level4">
<h4 id="approach-1-no-pooling">Approach 1: No pooling<a class="anchor" aria-label="anchor" href="#approach-1-no-pooling"></a>
</h4>
<p>No pooling (<code>pooling = "none"</code>, default) assumes no
similarities between strata. This means that the prior distribution
specified through <code>prior</code> is applied independently for each
stratum. This allows for independent estimates for the misstatement in
each stratum but also results in a relatively high uncertainty in the
population estimate. The call below evaluates the sample using a
Bayesian stratified evaluation procedure, in which the stratum estimates
are poststratified to arrive at the population estimate.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Important because the posterior distribution is determined via sampling</span></span>
<span><span class="va">result_np</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"binomial"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">samples</span>, x <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">errors</span>, N.units <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">items</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, pooling <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_np</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Population size:                144000 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ = 0.05 vs. H₁: Θ ≠ 0.05 </span></span>
<span><span class="co">##   Method:                         binomial </span></span>
<span><span class="co">##   Prior distribution:             Approximated via MCMC sampling </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    2575 </span></span>
<span><span class="co">##   Number of errors:               115 </span></span>
<span><span class="co">##   Sum of taints:                  115 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         Approximated via MCMC sampling </span></span>
<span><span class="co">##   Most likely error:              0.058487 </span></span>
<span><span class="co">##   95 percent credible interval:   [0.042763, 0.082201] </span></span>
<span><span class="co">##   Precision:                      0.023714 </span></span>
<span><span class="co">##   BF₁₀:                            0 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata (20):</span></span>
<span><span class="co">##        N   n  x  t     mle      lb      ub precision    bf10</span></span>
<span><span class="co">## 1   5000 300 21 21 0.07000 0.04637 0.10467   0.03467 0.11433</span></span>
<span><span class="co">## 2   5000 300 16 16 0.05333 0.03324 0.08489   0.03156 0.03372</span></span>
<span><span class="co">## 3   5000 300 15 15 0.05000 0.03069 0.08086   0.03086 0.03161</span></span>
<span><span class="co">## 4   5000 300 14 14 0.04667 0.02816 0.07681   0.03014 0.03172</span></span>
<span><span class="co">## 5   5000 300 16 16 0.05333 0.03324 0.08489   0.03156 0.03372</span></span>
<span><span class="co">## 6   5000 150  5  5 0.03333 0.01472 0.07558   0.04225 0.06084</span></span>
<span><span class="co">## 7   5000 150  4  4 0.02667 0.01084 0.06643   0.03977 0.09351</span></span>
<span><span class="co">## 8   5000 150  3  3 0.02000 0.00726 0.05696   0.03696 0.18087</span></span>
<span><span class="co">## 9   5000 150  4  4 0.02667 0.01084 0.06643   0.03977 0.09351</span></span>
<span><span class="co">## 10  5000 150  5  5 0.03333 0.01472 0.07558   0.04225 0.06084</span></span>
<span><span class="co">## 11 10000  50  2  2 0.04000 0.01230 0.13459   0.09459 0.07510</span></span>
<span><span class="co">## 12 10000  50  3  3 0.06000 0.02178 0.16242   0.10242 0.08918</span></span>
<span><span class="co">## 13 10000  50  2  2 0.04000 0.01230 0.13459   0.09459 0.07510</span></span>
<span><span class="co">## 14 10000  50  1  1 0.02000 0.00478 0.10447   0.08447 0.09684</span></span>
<span><span class="co">## 15 10000  50  0  0 0.00000 0.00050 0.06978   0.06978 0.25483</span></span>
<span><span class="co">## 16 10000  15  0  0 0.00000 0.00158 0.20591   0.20591 0.13490</span></span>
<span><span class="co">## 17 10000  15  0  0 0.00000 0.00158 0.20591   0.20591 0.13490</span></span>
<span><span class="co">## 18 10000  15  0  0 0.00000 0.00158 0.20591   0.20591 0.13490</span></span>
<span><span class="co">## 19 10000  15  1  1 0.06667 0.01551 0.30232   0.23565 0.17088</span></span>
<span><span class="co">## 20  4000  15  3  3 0.20000 0.07266 0.45646   0.25646 2.03365</span></span></code></pre>
<p>In this case, the output of the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function shows
that the estimate of the misstatement in the population is 5.85%, with
the 95% credible interval ranging from 4.28% to 8.22%. The stratum
estimates differ substantially from each other but are relatively
uncertain.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_np</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The prior and posterior distribution for the population misstatement
can be requested via the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_np</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="approach-2-complete-pooling">Approach 2: Complete pooling<a class="anchor" aria-label="anchor" href="#approach-2-complete-pooling"></a>
</h4>
<p>Complete pooling (<code>pooling = "complete"</code>) assumes no
differences between strata. This has the advantages that data from all
strata can be aggregated, which decreases the uncertainty in the
population estimate compared to the no pooling approach. However, the
disadvantage of this approach is that it does not facilitate the
distinction between between strata, as every stratum receives the same
estimate equal to that of the population. The call below evaluates the
sample using a Bayesian stratified evaluation procedure, in which the
strata are assumed to be the same.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_cp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"binomial"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">samples</span>, x <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">errors</span>, N.units <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">items</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, pooling <span class="op">=</span> <span class="st">"complete"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_cp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Population size:                144000 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ = 0.05 vs. H₁: Θ ≠ 0.05 </span></span>
<span><span class="co">##   Method:                         binomial </span></span>
<span><span class="co">##   Prior distribution:             beta(α = 1, β = 1) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    2575 </span></span>
<span><span class="co">##   Number of errors:               115 </span></span>
<span><span class="co">##   Sum of taints:                  115 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         beta(α = 116, β = 2461) </span></span>
<span><span class="co">##   Most likely error:              0.04466 </span></span>
<span><span class="co">##   95 percent credible interval:   [0.03735, 0.053345] </span></span>
<span><span class="co">##   Precision:                      0.0086852 </span></span>
<span><span class="co">##   BF₁₀:                            0.022725 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata (20):</span></span>
<span><span class="co">##        N   n  x  t     mle      lb      ub precision    bf10</span></span>
<span><span class="co">## 1   5000 300 21 21 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 2   5000 300 16 16 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 3   5000 300 15 15 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 4   5000 300 14 14 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 5   5000 300 16 16 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 6   5000 150  5  5 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 7   5000 150  4  4 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 8   5000 150  3  3 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 9   5000 150  4  4 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 10  5000 150  5  5 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 11 10000  50  2  2 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 12 10000  50  3  3 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 13 10000  50  2  2 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 14 10000  50  1  1 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 15 10000  50  0  0 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 16 10000  15  0  0 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 17 10000  15  0  0 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 18 10000  15  0  0 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 19 10000  15  1  1 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">## 20  4000  15  3  3 0.04466 0.03735 0.05335   0.00869 0.02273</span></span></code></pre>
<p>For example, the output of the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function shows
that the estimate of the misstatement in the population is 4.47%, with
the 95% credible interval ranging from 3.74% to 5.33%. Since the data is
aggregated, the stratum estimates contain relatively little uncertainty.
However, the probability of misstatement in stratum 20 (many
misstatements) under this assumption is the same as that of stratum 15
(few misstatements).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_cp</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The prior and posterior distribution for the population misstatement
can be requested via the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_cp</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="approach-3-partial-pooling">Approach 3: Partial pooling<a class="anchor" aria-label="anchor" href="#approach-3-partial-pooling"></a>
</h4>
<p>Finally, partial pooling (<code>pooling = "partial"</code>) assumes
differences and similarities between strata. This allows the auditor to
differentiate between strata, while also sharing information between the
strata to reduce uncertainty in the population estimate. The call below
evaluates the sample using a Bayesian stratified evaluation procedure,
in which the stratum estimates are poststratified to arrive at the
population estimate.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Important because the posterior distribution is determined via sampling</span></span>
<span><span class="va">result_pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"binomial"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">samples</span>, x <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">errors</span>, N.units <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">items</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, pooling <span class="op">=</span> <span class="st">"partial"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_binomial' NOW (CHAIN 1).</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Gradient evaluation took 5.5e-05 seconds</span></span>
<span><span class="co">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.55 seconds.</span></span>
<span><span class="co">## Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1:  Elapsed Time: 0.084115 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 1:                0.092135 seconds (Sampling)</span></span>
<span><span class="co">## Chain 1:                0.17625 seconds (Total)</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_binomial' NOW (CHAIN 2).</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2: Gradient evaluation took 1.1e-05 seconds</span></span>
<span><span class="co">## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.11 seconds.</span></span>
<span><span class="co">## Chain 2: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2:  Elapsed Time: 0.088918 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 2:                0.068471 seconds (Sampling)</span></span>
<span><span class="co">## Chain 2:                0.157389 seconds (Total)</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_binomial' NOW (CHAIN 3).</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3: Gradient evaluation took 1.4e-05 seconds</span></span>
<span><span class="co">## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.14 seconds.</span></span>
<span><span class="co">## Chain 3: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3:  Elapsed Time: 0.081114 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 3:                0.066292 seconds (Sampling)</span></span>
<span><span class="co">## Chain 3:                0.147406 seconds (Total)</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_binomial' NOW (CHAIN 4).</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4: Gradient evaluation took 1.1e-05 seconds</span></span>
<span><span class="co">## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.11 seconds.</span></span>
<span><span class="co">## Chain 4: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4:  Elapsed Time: 0.082859 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 4:                0.071344 seconds (Sampling)</span></span>
<span><span class="co">## Chain 4:                0.154203 seconds (Total)</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_binomial' NOW (CHAIN 1).</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Gradient evaluation took 3.5e-05 seconds</span></span>
<span><span class="co">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.35 seconds.</span></span>
<span><span class="co">## Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1:  Elapsed Time: 0.265803 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 1:                0.196236 seconds (Sampling)</span></span>
<span><span class="co">## Chain 1:                0.462039 seconds (Total)</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_binomial' NOW (CHAIN 2).</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2: Gradient evaluation took 1.6e-05 seconds</span></span>
<span><span class="co">## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.16 seconds.</span></span>
<span><span class="co">## Chain 2: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2:  Elapsed Time: 0.225249 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 2:                0.368331 seconds (Sampling)</span></span>
<span><span class="co">## Chain 2:                0.59358 seconds (Total)</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_binomial' NOW (CHAIN 3).</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3: Gradient evaluation took 2e-05 seconds</span></span>
<span><span class="co">## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.2 seconds.</span></span>
<span><span class="co">## Chain 3: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3:  Elapsed Time: 0.240802 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 3:                0.226208 seconds (Sampling)</span></span>
<span><span class="co">## Chain 3:                0.46701 seconds (Total)</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_binomial' NOW (CHAIN 4).</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4: Gradient evaluation took 1.6e-05 seconds</span></span>
<span><span class="co">## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.16 seconds.</span></span>
<span><span class="co">## Chain 4: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4:  Elapsed Time: 0.195052 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 4:                0.224669 seconds (Sampling)</span></span>
<span><span class="co">## Chain 4:                0.419721 seconds (Total)</span></span>
<span><span class="co">## Chain 4:</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_pp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Population size:                144000 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ = 0.05 vs. H₁: Θ ≠ 0.05 </span></span>
<span><span class="co">##   Method:                         binomial </span></span>
<span><span class="co">##   Prior distribution:             Approximated via MCMC sampling </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    2575 </span></span>
<span><span class="co">##   Number of errors:               115 </span></span>
<span><span class="co">##   Sum of taints:                  115 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         Approximated via MCMC sampling </span></span>
<span><span class="co">##   Most likely error:              0.043714 </span></span>
<span><span class="co">##   95 percent credible interval:   [0.034206, 0.053522] </span></span>
<span><span class="co">##   Precision:                      0.0098086 </span></span>
<span><span class="co">##   BF₁₀:                            0.019031 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata (20):</span></span>
<span><span class="co">##        N   n  x  t     mle      lb      ub precision    bf10</span></span>
<span><span class="co">## 1   5000 300 21 21 0.04809 0.03814 0.08017   0.03207 0.02275</span></span>
<span><span class="co">## 2   5000 300 16 16 0.04569 0.03328 0.06816   0.02247 0.02328</span></span>
<span><span class="co">## 3   5000 300 15 15 0.04497 0.03207 0.06407   0.01909 0.02232</span></span>
<span><span class="co">## 4   5000 300 14 14 0.04433 0.03043 0.06220   0.01787 0.02576</span></span>
<span><span class="co">## 5   5000 300 16 16 0.04620 0.03281 0.06708   0.02088 0.02224</span></span>
<span><span class="co">## 6   5000 150  5  5 0.04348 0.02367 0.05968   0.01620 0.03491</span></span>
<span><span class="co">## 7   5000 150  4  4 0.04126 0.02088 0.05677   0.01551 0.04136</span></span>
<span><span class="co">## 8   5000 150  3  3 0.04164 0.01846 0.05501   0.01337 0.04414</span></span>
<span><span class="co">## 9   5000 150  4  4 0.04229 0.02137 0.05677   0.01448 0.03998</span></span>
<span><span class="co">## 10  5000 150  5  5 0.04181 0.02328 0.05844   0.01663 0.03701</span></span>
<span><span class="co">## 11 10000  50  2  2 0.04410 0.02417 0.06688   0.02278 0.03079</span></span>
<span><span class="co">## 12 10000  50  3  3 0.04418 0.02616 0.07366   0.02948 0.02887</span></span>
<span><span class="co">## 13 10000  50  2  2 0.04318 0.02261 0.06669   0.02351 0.03211</span></span>
<span><span class="co">## 14 10000  50  1  1 0.04280 0.01993 0.06367   0.02087 0.03563</span></span>
<span><span class="co">## 15 10000  50  0  0 0.04234 0.01641 0.05928   0.01694 0.04182</span></span>
<span><span class="co">## 16 10000  15  0  0 0.04331 0.02039 0.06699   0.02369 0.03518</span></span>
<span><span class="co">## 17 10000  15  0  0 0.04424 0.02027 0.06700   0.02276 0.03323</span></span>
<span><span class="co">## 18 10000  15  0  0 0.04330 0.01984 0.06587   0.02257 0.03440</span></span>
<span><span class="co">## 19 10000  15  1  1 0.04293 0.02313 0.07342   0.03049 0.03109</span></span>
<span><span class="co">## 20  4000  15  3  3 0.04527 0.03047 0.10417   0.05889 0.02880</span></span></code></pre>
<p>In this case, the output shows that the estimate of the misstatement
in the population is 4.34%, with the 95% credible interval ranging from
3.45% to 5.33%. Note that this population estimate is substantially less
uncertain than that of the no pooling approach. Note that, like in the
no pooling approach, the stratum estimates are different from each other
but lie closer together and are less uncertain.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_pp</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The prior and posterior distribution for the population misstatement
can be requested via the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_pp</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-14-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="evaluation-using-data">Evaluation using data<a class="anchor" aria-label="anchor" href="#evaluation-using-data"></a>
</h2>
<p>For this example, we take the <code>allowances</code> that set that
comes with the package. This data set contains 3500 financial statement
line items, each with a booked value <code>bookValue</code> and, for
illustrative purposes, and audited (true) value <code>auditValue</code>.
Since the focus of this vignette is the evaluation stage in the audit,
the sample is already indicated in the data set. The performance
materiality in this example is set to 5%.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">allowances</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">allowances</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   item branch bookValue auditValue times</span></span>
<span><span class="co">## 1    1     12      1600       1600     1</span></span>
<span><span class="co">## 2    2     12      1625         NA     0</span></span>
<span><span class="co">## 3    3     12      1775         NA     0</span></span>
<span><span class="co">## 4    4     12      1250       1250     1</span></span>
<span><span class="co">## 5    5     12      1400         NA     0</span></span>
<span><span class="co">## 6    6     12      1190         NA     0</span></span></code></pre>
<div class="section level3">
<h3 id="non-stratified-samples-1">Non-stratified samples<a class="anchor" aria-label="anchor" href="#non-stratified-samples-1"></a>
</h3>
<p>Evaluating a non-stratified sample using data requires specification
of the <code>data</code>, <code>values</code> and
<code>values.audit</code> arguments. The input for these arguments is
the name of the specific column in <code>data</code>.</p>
<div class="section level4">
<h4 id="classical-evaluation-1">Classical evaluation<a class="anchor" aria-label="anchor" href="#classical-evaluation-1"></a>
</h4>
<p>The call below evaluates the <code>allowances</code> sample using a
classical non-stratified evaluation procedure.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, data <span class="op">=</span> <span class="va">allowances</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, times <span class="op">=</span> <span class="st">"times"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ &gt;= 0.05 vs. H₁: Θ &lt; 0.05 </span></span>
<span><span class="co">##   Method:                         poisson </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    1604 </span></span>
<span><span class="co">##   Number of errors:               401 </span></span>
<span><span class="co">##   Sum of taints:                  252.9281046 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Most likely error:              0.15769 </span></span>
<span><span class="co">##   95 percent confidence interval: [0, 0.175] </span></span>
<span><span class="co">##   Precision:                      0.017311 </span></span>
<span><span class="co">##   p-value:                        1</span></span></code></pre>
<p>In this case, the output shows that the estimate of the misstatement
in the population is 15.77%, with the 95% (one-sided) confidence
interval ranging from 0% to 17.5%.</p>
</div>
<div class="section level4">
<h4 id="bayesian-evaluation-1">Bayesian evaluation<a class="anchor" aria-label="anchor" href="#bayesian-evaluation-1"></a>
</h4>
<p>The call below evaluates the <code>allowances</code> sample using a
Bayesian non-stratified evaluation procedure.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, data <span class="op">=</span> <span class="va">allowances</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, times <span class="op">=</span> <span class="st">"times"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ &gt; 0.05 vs. H₁: Θ &lt; 0.05 </span></span>
<span><span class="co">##   Method:                         poisson </span></span>
<span><span class="co">##   Prior distribution:             gamma(α = 1, β = 1) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    1604 </span></span>
<span><span class="co">##   Number of errors:               401 </span></span>
<span><span class="co">##   Sum of taints:                  252.9281046 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         gamma(α = 253.928, β = 1605) </span></span>
<span><span class="co">##   Most likely error:              0.15759 </span></span>
<span><span class="co">##   95 percent credible interval:   [0, 0.17489] </span></span>
<span><span class="co">##   Precision:                      0.0173 </span></span>
<span><span class="co">##   BF₁₀:                            0</span></span></code></pre>
<p>The output shows that the estimate of the misstatement in the
population is 15.76%, with the 95% (one-sided) credible interval ranging
from 0% to 17.49%.</p>
</div>
</div>
<div class="section level3">
<h3 id="stratified-samples-1">Stratified samples<a class="anchor" aria-label="anchor" href="#stratified-samples-1"></a>
</h3>
<p>Evaluating a stratified sample using data requires specification of
the <code>data</code>, <code>values</code>, <code>values.audit</code>
and <code>strata</code> arguments in the <code><a href="../reference/evaluation.html">evaluation()</a></code>
function. In this case, the units are monetary and calculated by
aggregating the book values of the items in each stratum.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N.units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">allowances</span><span class="op">$</span><span class="va">bookValue</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">allowances</span><span class="op">$</span><span class="va">branch</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span><span class="op">$</span><span class="va">x</span></span></code></pre></div>
<div class="section level4">
<h4 id="classical-evaluation-2">Classical evaluation<a class="anchor" aria-label="anchor" href="#classical-evaluation-2"></a>
</h4>
<p>The call below evaluates the <code>allowances</code> sample using a
classical stratified evaluation procedure, in which the stratum
estimates are poststratified to arrive at the population estimate.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, data <span class="op">=</span> <span class="va">allowances</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, strata <span class="op">=</span> <span class="st">"branch"</span>, times <span class="op">=</span> <span class="st">"times"</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, N.units <span class="op">=</span> <span class="va">N.units</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Population size:                16772249 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ = 0.05 vs. H₁: Θ ≠ 0.05 </span></span>
<span><span class="co">##   Method:                         poisson </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    1604 </span></span>
<span><span class="co">##   Number of errors:               401 </span></span>
<span><span class="co">##   Sum of taints:                  252.9281046 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Most likely error:              0.14723 </span></span>
<span><span class="co">##   95 percent confidence interval: [0.12549, 0.18239] </span></span>
<span><span class="co">##   Precision:                      0.03516 </span></span>
<span><span class="co">##   p-value:                        NA </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata (16):</span></span>
<span><span class="co">##             N   n   x         t     mle      lb      ub precision p.value</span></span>
<span><span class="co">## 1   317200.09  87   6   1.27814 0.01469 0.00073 0.06950   0.05481 0.46285</span></span>
<span><span class="co">## 2  2792814.33 305 233 193.23313 0.63355 0.54558 0.72945   0.09590 0.00000</span></span>
<span><span class="co">## 3  1144231.69  55   3   3.00000 0.05455 0.01105 0.15940   0.10486 0.75827</span></span>
<span><span class="co">## 4   414202.89  70  45  15.05094 0.21501 0.11878 0.35434   0.13933 0.00000</span></span>
<span><span class="co">## 5    96660.53  18   1   0.64537 0.03585 0.00015 0.27456   0.23871 0.59343</span></span>
<span><span class="co">## 6   348006.13  34   1   0.17866 0.00525 0.00000 0.11926   0.11401 1.00000</span></span>
<span><span class="co">## 7  2384079.33  55  14   9.44448 0.17172 0.07885 0.32122   0.14950 0.00058</span></span>
<span><span class="co">## 8  1840399.33  96   1   0.00813 0.00008 0.00000 0.03860   0.03852 0.10355</span></span>
<span><span class="co">## 9   563957.70  92   0   0.00000 0.00000 0.00000 0.04010   0.04010 0.01783</span></span>
<span><span class="co">## 10 3198877.73 201   7   0.92023 0.00458 0.00009 0.02703   0.02245 0.00122</span></span>
<span><span class="co">## 11 1983299.06 128   7   1.50034 0.01172 0.00084 0.05013   0.03841 0.10773</span></span>
<span><span class="co">## 12  319144.13  86   5   1.68141 0.01955 0.00174 0.07806   0.05851 0.46069</span></span>
<span><span class="co">## 13  148905.79  25   0   0.00000 0.00000 0.00000 0.14756   0.14756 0.64187</span></span>
<span><span class="co">## 14  513058.76 150   0   0.00000 0.00000 0.00000 0.02459   0.02459 0.00134</span></span>
<span><span class="co">## 15  432007.61 150  39  21.80000 0.14533 0.09026 0.22045   0.07511 0.00001</span></span>
<span><span class="co">## 16  275403.70  52  39   4.18726 0.08052 0.02237 0.20215   0.12163 0.12258</span></span></code></pre>
<p>In this case, the output shows that the estimate of the misstatement
in the population is 14.72%, with the 95% confidence interval ranging
from 12.55% to 18.26%. The precision of the population estimate is
3.54%. The stratum estimates can be seen in the output of the
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function and are visualized below.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-20-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="bayesian-evaluation-2">Bayesian evaluation<a class="anchor" aria-label="anchor" href="#bayesian-evaluation-2"></a>
</h4>
<p>Bayesian inference can improve upon the estimates of the classical
approach by pooling information between strata where possible. The call
below evaluates the <code>allowances</code> sample using a Bayesian
multilevel stratified evaluation procedure, in which the stratum
estimates are poststratified to arrive at the population estimate.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, data <span class="op">=</span> <span class="va">allowances</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, strata <span class="op">=</span> <span class="st">"branch"</span>, times <span class="op">=</span> <span class="st">"times"</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, N.units <span class="op">=</span> <span class="va">N.units</span>, pooling <span class="op">=</span> <span class="st">"partial"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_beta' NOW (CHAIN 1).</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Gradient evaluation took 3.7e-05 seconds</span></span>
<span><span class="co">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.37 seconds.</span></span>
<span><span class="co">## Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1:  Elapsed Time: 0.279696 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 1:                0.180585 seconds (Sampling)</span></span>
<span><span class="co">## Chain 1:                0.460281 seconds (Total)</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_beta' NOW (CHAIN 2).</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2: Gradient evaluation took 1.9e-05 seconds</span></span>
<span><span class="co">## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.19 seconds.</span></span>
<span><span class="co">## Chain 2: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2:  Elapsed Time: 0.248 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 2:                0.28379 seconds (Sampling)</span></span>
<span><span class="co">## Chain 2:                0.53179 seconds (Total)</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_beta' NOW (CHAIN 3).</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3: Gradient evaluation took 1.7e-05 seconds</span></span>
<span><span class="co">## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.17 seconds.</span></span>
<span><span class="co">## Chain 3: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3:  Elapsed Time: 0.255566 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 3:                0.302463 seconds (Sampling)</span></span>
<span><span class="co">## Chain 3:                0.558029 seconds (Total)</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_beta' NOW (CHAIN 4).</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4: Gradient evaluation took 1.6e-05 seconds</span></span>
<span><span class="co">## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.16 seconds.</span></span>
<span><span class="co">## Chain 4: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4:  Elapsed Time: 0.298957 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 4:                0.213877 seconds (Sampling)</span></span>
<span><span class="co">## Chain 4:                0.512834 seconds (Total)</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_beta' NOW (CHAIN 1).</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Gradient evaluation took 0.000494 seconds</span></span>
<span><span class="co">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 4.94 seconds.</span></span>
<span><span class="co">## Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1:  Elapsed Time: 63.1164 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 1:                58.7905 seconds (Sampling)</span></span>
<span><span class="co">## Chain 1:                121.907 seconds (Total)</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_beta' NOW (CHAIN 2).</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2: Gradient evaluation took 0.000483 seconds</span></span>
<span><span class="co">## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 4.83 seconds.</span></span>
<span><span class="co">## Chain 2: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## Chain 2:  Elapsed Time: 64.3 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 2:                60.0684 seconds (Sampling)</span></span>
<span><span class="co">## Chain 2:                124.368 seconds (Total)</span></span>
<span><span class="co">## Chain 2: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_beta' NOW (CHAIN 3).</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3: Gradient evaluation took 0.000283 seconds</span></span>
<span><span class="co">## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 2.83 seconds.</span></span>
<span><span class="co">## Chain 3: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## Chain 3:  Elapsed Time: 67.2094 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 3:                58.8181 seconds (Sampling)</span></span>
<span><span class="co">## Chain 3:                126.027 seconds (Total)</span></span>
<span><span class="co">## Chain 3: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SAMPLING FOR MODEL 'pp_beta' NOW (CHAIN 4).</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4: Gradient evaluation took 0.000783 seconds</span></span>
<span><span class="co">## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 7.83 seconds.</span></span>
<span><span class="co">## Chain 4: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">## Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">## Chain 4: </span></span>
<span><span class="co">## Chain 4:  Elapsed Time: 60.5909 seconds (Warm-up)</span></span>
<span><span class="co">## Chain 4:                57.3049 seconds (Sampling)</span></span>
<span><span class="co">## Chain 4:                117.896 seconds (Total)</span></span>
<span><span class="co">## Chain 4:</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Population size:                16772249 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ = 0.05 vs. H₁: Θ ≠ 0.05 </span></span>
<span><span class="co">##   Method:                         poisson </span></span>
<span><span class="co">##   Prior distribution:             Approximated via MCMC sampling </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    1350 </span></span>
<span><span class="co">##   Number of errors:               401 </span></span>
<span><span class="co">##   Sum of taints:                  224.657517 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         Approximated via MCMC sampling </span></span>
<span><span class="co">##   Most likely error:              0.1555 </span></span>
<span><span class="co">##   95 percent credible interval:   [0.1458, 0.17009] </span></span>
<span><span class="co">##   Precision:                      0.014595 </span></span>
<span><span class="co">##   BF₁₀:                            3.1386e+15 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata (16):</span></span>
<span><span class="co">##             N   n   x         t     mle      lb      ub precision         bf10</span></span>
<span><span class="co">## 1   317200.09  62   6   1.07814 0.02037 0.01356 0.03659   0.01622 5.610460e+00</span></span>
<span><span class="co">## 2  2792814.33 283 233 176.87807 0.60930 0.57298 0.65128   0.04198 5.250548e+15</span></span>
<span><span class="co">## 3  1144231.69  55   3   3.00000 0.16735 0.11682 0.24582   0.07847 1.698133e+09</span></span>
<span><span class="co">## 4   414202.89  48  45  11.65094 0.27653 0.22254 0.34868   0.07214 9.013376e+15</span></span>
<span><span class="co">## 5    96660.53   9   1   0.21512 0.02207 0.01055 0.08932   0.06725 1.900000e-01</span></span>
<span><span class="co">## 6   348006.13  14   1   0.04467 0.01233 0.00723 0.04022   0.02790 1.793090e+00</span></span>
<span><span class="co">## 7  2384079.33  44  14   6.65401 0.13637 0.09156 0.21540   0.07903 3.018715e+02</span></span>
<span><span class="co">## 8  1840399.33  78   1   0.00813 0.00640 0.00458 0.00961   0.00320 1.676498e+15</span></span>
<span><span class="co">## 9   563957.70  74   0   0.00000 0.00608 0.00461 0.00957   0.00349 8.765740e+15</span></span>
<span><span class="co">## 10 3198877.73 184   7   0.89982 0.00804 0.00615 0.01074   0.00270          Inf</span></span>
<span><span class="co">## 11 1983299.06 111   7   1.35066 0.01525 0.01077 0.02243   0.00718          Inf</span></span>
<span><span class="co">## 12  319144.13  56   5   1.19069 0.08428 0.05625 0.14502   0.06074 7.474100e-01</span></span>
<span><span class="co">## 13  148905.79  10   0   0.00000 0.01216 0.00636 0.04545   0.03329 9.800700e-01</span></span>
<span><span class="co">## 14  513058.76 150   0   0.00000 0.00472 0.00377 0.00633   0.00161 7.486415e+14</span></span>
<span><span class="co">## 15  432007.61 128  39  18.30000 0.27398 0.23217 0.33730   0.06332 3.165278e+16</span></span>
<span><span class="co">## 16  275403.70  44  39   3.38726 0.07640 0.05784 0.10161   0.02521 1.485290e+00</span></span></code></pre>
<p>The output shows that the estimate of the misstatement in the
population is 15.66%, with the 95% credible interval ranging from 14.59%
to 17%. The precision of the population estimate is 1.34%, which is
substantially lower than that of the classical approach. The stratum
estimates can be seen in the output of the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
function and are visualized below.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-22-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The prior and posterior distribution for the population misstatement
can be requested via the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-23-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Derks, K., de Swart, J., van Batenburg, P., Wagenmakers, E.-J., and
Wetzels, R. (2021). Priors in a Bayesian audit: How integration of
existing information into the prior distribution can improve audit
transparency and efficiency. <em>International Journal of Auditing</em>,
25(3), 621-636. <a href="https://doi.org/10.1111/ijau.12240" class="external-link uri">https://doi.org/10.1111/ijau.12240</a>
</li>
<li>Derks, K., de Swart, J., Wagenmakers, E.-J., &amp; Wetzels, R.
(2021). The Bayesian Approach to Audit Evidence: Quantifying Statistical
Evidence using the Bayes Factor. <em>PsyArXiv</em>. <a href="https://doi.org/10.31234/osf.io/kzqp5" class="external-link uri">https://doi.org/10.31234/osf.io/kzqp5</a>
</li>
<li>Derks, K., de Swart, J., Wagenmakers, E.-J., &amp; Wetzels, R.
(2022). Bayesian Generalized Linear Modeling for Audit Sampling: How to
Incorporate Audit Information into the Statistical Model.
<em>PsyArXiv</em>. <a href="https://doi.org/10.31234/osf.io/byj2a" class="external-link uri">https://doi.org/10.31234/osf.io/byj2a</a>
</li>
<li>Stewart, T. R. (2012). <em>Technical Notes on the AICPA Audit Guide
Audit Sampling</em>. American Institute of Certified Public Accountants,
New York.</li>
<li>Stewart, T. R. (2013). <em>A Bayesian Audit Assurance Model with
Application to the Component Materiality problem in Group Audits</em>.
VU University, Amsterdam.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://koenderks.com" class="external-link">Koen Derks</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
