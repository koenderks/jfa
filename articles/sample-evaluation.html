<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evaluating statistical audit samples • jfa</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Evaluating statistical audit samples">
<meta property="og:description" content="jfa">
<meta property="og:image" content="https://koenderks.github.io/jfa/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/jfa.html">Get started</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/koenderks/jfa" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/koenderks/jfa/discussions" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Evaluating statistical audit samples</h1>
                        <h4 data-toc-skip class="author">Koen Derks</h4>
            
            <h4 data-toc-skip class="date">2023-11-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/koenderks/jfa/blob/HEAD/vignettes/sample-evaluation.Rmd" class="external-link"><code>vignettes/sample-evaluation.Rmd</code></a></small>
      <div class="hidden name"><code>sample-evaluation.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to evaluate a sample with the
<code><a href="../reference/evaluation.html">evaluation()</a></code> function from the <strong>jfa</strong>
package.</p>
<p align="center">
<img src="evaluation.png" alt="evaluation" width="100%"></p>
<p>In auditing, the goal of the evaluation is typically to estimate the
misstatement in the population based on a sample, or to test the
misstatement in the population against a critical upper limit, referred
to as the performance materiality.</p>
</div>
<div class="section level2">
<h2 id="required-information">Required information<a class="anchor" aria-label="anchor" href="#required-information"></a>
</h2>
<p>Evaluating an audit sample using the <code><a href="../reference/evaluation.html">evaluation()</a></code>
function requires that the sample data is available in one of two
forms:</p>
<ul>
<li>
<strong>Summary statistics:</strong> This includes (a vector of) the
number of items (<code>n</code>), (a vector of) the sum of errors /
taints (<code>x</code>) and optionally (a vector of) the number of units
in the population (<code>N.units</code>).</li>
<li>
<strong>Data:</strong> A <code>data.frame</code> containing a
numeric column with book values (<code>values</code>), a numeric column
with audit (true) values (<code>values.audit</code>) and optionally a
factor column indicating stratum membership (<code>strata</code>).</li>
</ul>
<p>By default, <code><a href="../reference/evaluation.html">evaluation()</a></code> estimates the population
misstatement and returns a point estimate as well as a
(<code>conf.level</code> <span class="math inline">\(\times\)</span>
100) percent confidence / credible interval around this estimate.
However, in audit sampling, the population is typically subject to a
certain maximum tolerable misstatement defined by the performance
materiality <span class="math inline">\(\theta_{max}\)</span>. Using the
<code>materiality</code> argument, you can provide this critical value
to the <code><a href="../reference/evaluation.html">evaluation()</a></code> function as a fraction. In addition to
the estimation that is performed by default, specifying
<code>materiality</code> triggers the comparison of two competing
hypotheses. Which hypotheses are being compared depends on the input for
the <code>alternative</code> argument:</p>
<ul>
<li>
<code>alternative = "less"</code> (default): <span class="math inline">\(H_1:\theta&lt;\theta_{max}\)</span> versus <span class="math inline">\(H_0:\theta\geq\theta_{max}\)</span>
</li>
<li>
<code>alternative = "greater"</code>: <span class="math inline">\(H_1:\theta&gt;\theta_{max}\)</span> versus <span class="math inline">\(H_0:\theta\leq\theta_{max}\)</span>
</li>
<li>
<code>alternative = "two.sided"</code>: <span class="math inline">\(H_1:\theta \neq\theta_{max}\)</span> versus <span class="math inline">\(H_0:\theta=\theta_{max}\)</span>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="evaluation-using-summary-statistics">Evaluation using summary statistics<a class="anchor" aria-label="anchor" href="#evaluation-using-summary-statistics"></a>
</h2>
<div class="section level3">
<h3 id="non-stratified-samples">Non-stratified samples<a class="anchor" aria-label="anchor" href="#non-stratified-samples"></a>
</h3>
<p>In a non-stratified sampling procedure, the auditor does not take
samples from different strata or subgroups in a population. An example
of such a situation would be where the auditor is auditing the general
ledger of a small business.</p>
<div class="section level4">
<h4 id="classical-evaluation">Classical evaluation<a class="anchor" aria-label="anchor" href="#classical-evaluation"></a>
</h4>
<p>Classical hypothesis testing uses the <em>p</em>-value to make a
decision about whether to reject the hypothesis <span class="math inline">\(H_0\)</span> or not. As an example, consider that
an auditor wants to verify whether the population contains less than 5
percent misstatement, implying the hypotheses <span class="math inline">\(H_1:\theta&lt;0.05\)</span> and <span class="math inline">\(H_0:\theta\geq0.05\)</span>. They have taken a
sample of 100 items, of which 1 contained an error. They set the
significance level for the <em>p</em>-value to 0.05, implying that <span class="math inline">\(p &lt; 0.05\)</span> will be enough to reject the
hypothesis <span class="math inline">\(H_0\)</span>. The call below
evaluates the sample using a classical non-stratified evaluation
procedure <span class="citation">(Stewart, 2012)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  1 and 100</span></span>
<span><span class="co">## number of errors = 1, number of samples = 100, taint = 1, p-value =</span></span>
<span><span class="co">## 0.040428</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.05</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.00000000 0.04743865</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.01 </span></span>
<span><span class="co">## results obtained via method 'poisson'</span></span></code></pre>
<p>The output shows that the most likely error in the population is
estimated to be 1 / 100 = 1 percent and that the 95 percent (one-sided)
confidence interval ranges from 0 percent to 4.74 percent. The output
also shows that the <em>p</em>-value is lower than 0.05 implying that
the hypothesis <span class="math inline">\(H_0\)</span> can be rejected.
Hence, the auditor is able to conclude that the sample provides
sufficient evidence to state with reasonable assurance that the
population does not contain material misstatement.</p>
</div>
<div class="section level4">
<h4 id="bayesian-evaluation">Bayesian evaluation<a class="anchor" aria-label="anchor" href="#bayesian-evaluation"></a>
</h4>
<p>Bayesian hypothesis testing uses the Bayes factor, <span class="math inline">\(BF_{10}\)</span> or <span class="math inline">\(BF_{01}\)</span>, to make a statement about the
evidence provided by the sample in support for one of the two hypotheses
<span class="math inline">\(H_1\)</span> or <span class="math inline">\(H_0\)</span> <span class="citation">(Derks, Swart,
Wagenmakers, et al., 2021)</span>. As an example of how to interpret the
Bayes factor, the value of <span class="math inline">\(BF_{10} =
10\)</span> (provided by the <code><a href="../reference/evaluation.html">evaluation()</a></code> function) can be
interpreted as: <em>the data are 10 times more likely to have occurred
under the hypothesis <span class="math inline">\(H_1\)</span> than under
the hypothesis <span class="math inline">\(H_0\)</span></em>. <span class="math inline">\(BF_{10} &gt; 1\)</span> indicates evidence in
favor of <span class="math inline">\(H_1\)</span> and against <span class="math inline">\(H_0\)</span>, while <span class="math inline">\(BF_{10} &lt; 1\)</span> indicates evidence in
favor of <span class="math inline">\(H_0\)</span> and against <span class="math inline">\(H_1\)</span>. The <code><a href="../reference/evaluation.html">evaluation()</a></code>
function returns the value for <span class="math inline">\(BF_{10}\)</span>, but <span class="math inline">\(BF_{01}\)</span> can be computed as <span class="math inline">\(\frac{1}{BF_{10}}\)</span>.</p>
<p>Consider the previous example of an auditor who wants to verify
whether the population contains less than 5 percent misstatement,
implying the hypotheses <span class="math inline">\(H_1:\theta&lt;0.05\)</span> and <span class="math inline">\(H_0:\theta\geq0.05\)</span>. They have taken a
sample of 100 items, of which 1 was found to contain a misstatement. The
prior distribution is assumed to be a default <em>beta(1,1)</em> prior.
The call below evaluates the sample using a Bayesian non-stratified
evaluation procedure <span class="citation">(Derks, Swart, Batenburg, et
al., 2021; Stewart, 2013)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">100</span>, method <span class="op">=</span> <span class="st">"binomial"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  1 and 100</span></span>
<span><span class="co">## number of errors = 1, number of samples = 100, taint = 1, BF₁₀ = 515.86</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.05</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.00000000 0.04610735</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.01 </span></span>
<span><span class="co">## results obtained via method 'binomial' + 'prior'</span></span></code></pre>
<p>The output shows that the most likely error in the population is
estimated to be 1 / 100 = 1 percent and that the 95 percent (one-sided)
credible interval ranges from 0 percent to 4.61 percent. The small
difference between the classical and default Bayesian results is due to
the prior distribution, which must be proper in order to calculate a
Bayes factor (classical results can be emulated by constructing a prior
with <code>method = "strict"</code> in the <code><a href="../reference/auditPrior.html">auditPrior()</a></code>
function). The Bayes factor in this case is shown to be <span class="math inline">\(BF_{10}=515\)</span>, meaning that the data from
the sample are about 515 times more likely to occur under the hypothesis
of tolerable misstatement than under the hypothesis of material
misstatement.</p>
<p>Note that this is a very high Bayes factor for the little data that
is observed. That is because the Bayes factor is dependent on the prior
distribution for <span class="math inline">\(\theta\)</span>. As a rule
of thumb, when the prior distribution is highly conservative (as with
<code>method = 'default'</code>) with respect to the hypothesis of
tolerable misstatement, the Bayes factor tends to over quantify the
evidence in favor of this hypothesis. You can mitigate this dependency
by using a prior distribution that is impartial with respect to the
hypotheses via <code>method = "impartial"</code> in the
<code><a href="../reference/auditPrior.html">auditPrior()</a></code> function <span class="citation">(Derks et al.,
2022a)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auditPrior.html">auditPrior</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"impartial"</span>, likelihood <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">100</span>, prior <span class="op">=</span> <span class="va">prior</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  1 and 100</span></span>
<span><span class="co">## number of errors = 1, number of samples = 100, taint = 1, BF₁₀ = 47.435</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.05</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.00000000 0.04110834</span></span>
<span><span class="co">## most likely estimate:</span></span>
<span><span class="co">##  0.0088878 </span></span>
<span><span class="co">## results obtained via method 'binomial' + 'prior'</span></span></code></pre>
<p>The output shows that <span class="math inline">\(BF_{10}=47\)</span>, implying that under the
assumption of impartiality there is strong evidence for <span class="math inline">\(H_1\)</span>, the hypothesis that the population
contains misstatements lower than 5 percent of the population (tolerable
misstatement). Since the two prior distributions both resulted in
convincing Bayes factors, the results can be considered robust to the
choice of prior distribution. Hence, the auditor is able to conclude
that the sample provides convincing evidence to state that the
population does not contain material misstatement.</p>
</div>
</div>
<div class="section level3">
<h3 id="stratified-samples">Stratified samples<a class="anchor" aria-label="anchor" href="#stratified-samples"></a>
</h3>
<p>In a stratified sampling procedure, the auditor takes samples from
different strata (or subgroups) in a population. An example of such a
situation would be a group audit where the audited organization consists
of different components or branches. Stratification is relevant for the
group auditor if they must form an opinion on the group as a whole
because they must aggregate the samples taken by the component
auditors.</p>
<p>As a data example, consider the <code>retailer</code> data set that
comes with the package. The organization in question consists of 20
branches across the country. In each of the 20 strata, a component
auditor has taken a statistical sample and reported the outcomes to the
group auditor.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">retailer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">retailer</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    stratum items samples errors</span></span>
<span><span class="co">## 1        1  5000     300     21</span></span>
<span><span class="co">## 2        2  5000     300     16</span></span>
<span><span class="co">## 3        3  5000     300     15</span></span>
<span><span class="co">## 4        4  5000     300     14</span></span>
<span><span class="co">## 5        5  5000     300     16</span></span>
<span><span class="co">## 6        6  5000     150      5</span></span>
<span><span class="co">## 7        7  5000     150      4</span></span>
<span><span class="co">## 8        8  5000     150      3</span></span>
<span><span class="co">## 9        9  5000     150      4</span></span>
<span><span class="co">## 10      10  5000     150      5</span></span>
<span><span class="co">## 11      11 10000      50      2</span></span>
<span><span class="co">## 12      12 10000      50      3</span></span>
<span><span class="co">## 13      13 10000      50      2</span></span>
<span><span class="co">## 14      14 10000      50      1</span></span>
<span><span class="co">## 15      15 10000      50      0</span></span>
<span><span class="co">## 16      16 10000      15      0</span></span>
<span><span class="co">## 17      17 10000      15      0</span></span>
<span><span class="co">## 18      18 10000      15      0</span></span>
<span><span class="co">## 19      19 10000      15      1</span></span>
<span><span class="co">## 20      20  4000      15      3</span></span></code></pre>
<p>In general, there are three approaches to evaluating a stratified
sample: no pooling, complete pooling, and partial pooling <span class="citation">(see Derks et al., 2022b)</span>. When using
<code><a href="../reference/evaluation.html">evaluation()</a></code>, you must to indicate which type of pooling to
use via the <code>pooling</code> argument. No pooling assumes no
similarities between strata, which means that all strata are analyzed
independently. Complete pooling assumes no difference between strata,
which means that all data is aggregated and analyzed as a whole.
Finally, partial pooling assumes differences and similarities between
strata, which means that information can be shared between strata.
Partial pooling (i.e., multilevel/hierarchical modeling) is a powerful
technique that can result in more efficient population and stratum
estimates but is currently only feasible when performing a Bayesian
analysis. For this reason, this vignette only describes the Bayesian
approach to stratified evaluation but going from this approach to a
classical approach only requires setting <code>prior = FALSE</code>.</p>
<p>The number of units per stratum in the population can be provided
with <code>N.units</code> to weigh the stratum estimates to determine
population estimate. This is called poststratification. If
<code>N.units</code> is not specified, each stratum is assumed to be
equally represented in the population.</p>
<div class="section level4">
<h4 id="approach-1-no-pooling">Approach 1: No pooling<a class="anchor" aria-label="anchor" href="#approach-1-no-pooling"></a>
</h4>
<p>No pooling (<code>pooling = "none"</code>, default) assumes no
similarities between strata. This means that the prior distribution
specified through <code>prior</code> is applied independently for each
stratum. This allows for independent estimates for the misstatement in
each stratum but also results in a relatively high uncertainty in the
population estimate. The call below evaluates the sample using a
Bayesian stratified evaluation procedure, in which the stratum estimates
are poststratified to arrive at the population estimate.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Important because the posterior distribution is determined via sampling</span></span>
<span><span class="va">result_np</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"binomial"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">samples</span>, x <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">errors</span>, N.units <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">items</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, pooling <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_np</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Population size:                144000 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ = 0.05 vs. H₁: Θ ≠ 0.05 </span></span>
<span><span class="co">##   Method:                         binomial </span></span>
<span><span class="co">##   Prior distribution:             Nonparametric </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    2575 </span></span>
<span><span class="co">##   Number of errors:               115 </span></span>
<span><span class="co">##   Sum of taints:                  115 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         Nonparametric </span></span>
<span><span class="co">##   Most likely error:              0.0598 </span></span>
<span><span class="co">##   95 percent credible interval:   [0.042763, 0.082201] </span></span>
<span><span class="co">##   Precision:                      0.022401 </span></span>
<span><span class="co">##   BF₁₀:                            0 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata (20):</span></span>
<span><span class="co">##          N   n  x  t     mle      lb      ub precision</span></span>
<span><span class="co">##   1   5000 300 21 21 0.07000 0.04637 0.10467   0.03467</span></span>
<span><span class="co">##   2   5000 300 16 16 0.05333 0.03324 0.08489   0.03156</span></span>
<span><span class="co">##   3   5000 300 15 15 0.05000 0.03069 0.08086   0.03086</span></span>
<span><span class="co">##   4   5000 300 14 14 0.04667 0.02816 0.07681   0.03014</span></span>
<span><span class="co">##   5   5000 300 16 16 0.05333 0.03324 0.08489   0.03156</span></span>
<span><span class="co">##   6   5000 150  5  5 0.03333 0.01472 0.07558   0.04225</span></span>
<span><span class="co">##   7   5000 150  4  4 0.02667 0.01084 0.06643   0.03977</span></span>
<span><span class="co">##   8   5000 150  3  3 0.02000 0.00726 0.05696   0.03696</span></span>
<span><span class="co">##   9   5000 150  4  4 0.02667 0.01084 0.06643   0.03977</span></span>
<span><span class="co">##   10  5000 150  5  5 0.03333 0.01472 0.07558   0.04225</span></span>
<span><span class="co">##   11 10000  50  2  2 0.04000 0.01230 0.13459   0.09459</span></span>
<span><span class="co">##   12 10000  50  3  3 0.06000 0.02178 0.16242   0.10242</span></span>
<span><span class="co">##   13 10000  50  2  2 0.04000 0.01230 0.13459   0.09459</span></span>
<span><span class="co">##   14 10000  50  1  1 0.02000 0.00478 0.10447   0.08447</span></span>
<span><span class="co">##   15 10000  50  0  0 0.00000 0.00050 0.06978   0.06978</span></span>
<span><span class="co">##   16 10000  15  0  0 0.00000 0.00158 0.20591   0.20591</span></span>
<span><span class="co">##   17 10000  15  0  0 0.00000 0.00158 0.20591   0.20591</span></span>
<span><span class="co">##   18 10000  15  0  0 0.00000 0.00158 0.20591   0.20591</span></span>
<span><span class="co">##   19 10000  15  1  1 0.06667 0.01551 0.30232   0.23565</span></span>
<span><span class="co">##   20  4000  15  3  3 0.20000 0.07266 0.45646   0.25646</span></span></code></pre>
<p>In this case, the output of the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function shows
that the estimate of the misstatement in the population is 5.85 percent,
with the 95 percent credible interval ranging from 4.28 percent to 8.22
percent. The stratum estimates differ substantially from each other but
are relatively uncertain.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_np</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The prior and posterior distribution for the population misstatement
can be requested via the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_np</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="approach-2-complete-pooling">Approach 2: Complete pooling<a class="anchor" aria-label="anchor" href="#approach-2-complete-pooling"></a>
</h4>
<p>Complete pooling (<code>pooling = "complete"</code>) assumes no
differences between strata. This has the advantages that data from all
strata can be aggregated, which decreases the uncertainty in the
population estimate compared to the no pooling approach. However, the
disadvantage of this approach is that it does not facilitate the
distinction between between strata, as every stratum receives the same
estimate equal to that of the population. The call below evaluates the
sample using a Bayesian stratified evaluation procedure, in which the
strata are assumed to be the same.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_cp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"binomial"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">samples</span>, x <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">errors</span>, N.units <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">items</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, pooling <span class="op">=</span> <span class="st">"complete"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_cp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Population size:                144000 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ = 0.05 vs. H₁: Θ ≠ 0.05 </span></span>
<span><span class="co">##   Method:                         binomial </span></span>
<span><span class="co">##   Prior distribution:             beta(α = 1, β = 1) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    2575 </span></span>
<span><span class="co">##   Number of errors:               115 </span></span>
<span><span class="co">##   Sum of taints:                  115 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         beta(α = 116, β = 2461) </span></span>
<span><span class="co">##   Most likely error:              0.04466 </span></span>
<span><span class="co">##   95 percent credible interval:   [0.03735, 0.053345] </span></span>
<span><span class="co">##   Precision:                      0.0086852 </span></span>
<span><span class="co">##   BF₁₀:                            0.022725 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata (20):</span></span>
<span><span class="co">##          N   n  x  t     mle      lb      ub precision    bf10</span></span>
<span><span class="co">##   1   5000 300 21 21 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   2   5000 300 16 16 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   3   5000 300 15 15 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   4   5000 300 14 14 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   5   5000 300 16 16 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   6   5000 150  5  5 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   7   5000 150  4  4 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   8   5000 150  3  3 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   9   5000 150  4  4 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   10  5000 150  5  5 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   11 10000  50  2  2 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   12 10000  50  3  3 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   13 10000  50  2  2 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   14 10000  50  1  1 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   15 10000  50  0  0 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   16 10000  15  0  0 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   17 10000  15  0  0 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   18 10000  15  0  0 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   19 10000  15  1  1 0.04466 0.03735 0.05335   0.00869 0.02273</span></span>
<span><span class="co">##   20  4000  15  3  3 0.04466 0.03735 0.05335   0.00869 0.02273</span></span></code></pre>
<p>For example, the output of the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function shows
that the estimate of the misstatement in the population is 4.47 percent,
with the 95 percent credible interval ranging from 3.74 percent to 5.33
percent. Since the data is aggregated, the stratum estimates contain
relatively little uncertainty. However, the probability of misstatement
in stratum 20 (many misstatements) under this assumption is the same as
that of stratum 15 (few misstatements).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_cp</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The prior and posterior distribution for the population misstatement
can be requested via the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_cp</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="approach-3-partial-pooling">Approach 3: Partial pooling<a class="anchor" aria-label="anchor" href="#approach-3-partial-pooling"></a>
</h4>
<p>Finally, partial pooling (<code>pooling = "partial"</code>) assumes
differences and similarities between strata. This allows the auditor to
differentiate between strata, while also sharing information between the
strata to reduce uncertainty in the population estimate. The call below
evaluates the sample using a Bayesian stratified evaluation procedure,
in which the stratum estimates are poststratified to arrive at the
population estimate.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Important because the posterior distribution is determined via sampling</span></span>
<span><span class="va">result_pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"binomial"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">samples</span>, x <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">errors</span>, N.units <span class="op">=</span> <span class="va">retailer</span><span class="op">$</span><span class="va">items</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, pooling <span class="op">=</span> <span class="st">"partial"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_pp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Population size:                144000 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ = 0.05 vs. H₁: Θ ≠ 0.05 </span></span>
<span><span class="co">##   Method:                         binomial </span></span>
<span><span class="co">##   Prior distribution:             Nonparametric </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    2575 </span></span>
<span><span class="co">##   Number of errors:               115 </span></span>
<span><span class="co">##   Sum of taints:                  115 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         Nonparametric </span></span>
<span><span class="co">##   Most likely error:              0.0408 </span></span>
<span><span class="co">##   95 percent credible interval:   [0.032695, 0.053314] </span></span>
<span><span class="co">##   Precision:                      0.012514 </span></span>
<span><span class="co">##   BF₁₀:                            0.046423 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata (20):</span></span>
<span><span class="co">##          N   n  x  t    mle      lb      ub precision</span></span>
<span><span class="co">##   1   5000 300 21 21 0.0605 0.03949 0.08845   0.02795</span></span>
<span><span class="co">##   2   5000 300 16 16 0.0464 0.03201 0.07198   0.02558</span></span>
<span><span class="co">##   3   5000 300 15 15 0.0477 0.03024 0.07115   0.02345</span></span>
<span><span class="co">##   4   5000 300 14 14 0.0420 0.02798 0.06680   0.02480</span></span>
<span><span class="co">##   5   5000 300 16 16 0.0429 0.03181 0.07412   0.03122</span></span>
<span><span class="co">##   6   5000 150  5  5 0.0369 0.01762 0.06279   0.02589</span></span>
<span><span class="co">##   7   5000 150  4  4 0.0376 0.01495 0.05792   0.02032</span></span>
<span><span class="co">##   8   5000 150  3  3 0.0290 0.01194 0.05522   0.02622</span></span>
<span><span class="co">##   9   5000 150  4  4 0.0349 0.01477 0.05997   0.02507</span></span>
<span><span class="co">##   10  5000 150  5  5 0.0393 0.01832 0.06369   0.02439</span></span>
<span><span class="co">##   11 10000  50  2  2 0.0315 0.01709 0.08053   0.04903</span></span>
<span><span class="co">##   12 10000  50  3  3 0.0465 0.02167 0.08881   0.04231</span></span>
<span><span class="co">##   13 10000  50  2  2 0.0372 0.01679 0.08128   0.04408</span></span>
<span><span class="co">##   14 10000  50  1  1 0.0428 0.01172 0.06965   0.02685</span></span>
<span><span class="co">##   15 10000  50  0  0 0.0396 0.00557 0.06191   0.02231</span></span>
<span><span class="co">##   16 10000  15  0  0 0.0401 0.00896 0.07797   0.03787</span></span>
<span><span class="co">##   17 10000  15  0  0 0.0383 0.00854 0.07956   0.04126</span></span>
<span><span class="co">##   18 10000  15  0  0 0.0323 0.00811 0.08168   0.04938</span></span>
<span><span class="co">##   19 10000  15  1  1 0.0453 0.01630 0.09706   0.05176</span></span>
<span><span class="co">##   20  4000  15  3  3 0.0455 0.02834 0.14270   0.09720</span></span></code></pre>
<p>In this case, the output shows that the estimate of the misstatement
in the population is 4.34 percent, with the 95 percent credible interval
ranging from 3.45 percent to 5.33 percent. Note that this population
estimate is substantially less uncertain than that of the no pooling
approach. Note that, like in the no pooling approach, the stratum
estimates are different from each other but lie closer together and are
less uncertain.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_pp</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The prior and posterior distribution for the population misstatement
can be requested via the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_pp</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-14-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="evaluation-using-data">Evaluation using data<a class="anchor" aria-label="anchor" href="#evaluation-using-data"></a>
</h2>
<p>For this example, we take the <code>allowances</code> that set that
comes with the package. This data set contains 3500 financial statement
line items, each with a booked value <code>bookValue</code> and, for
illustrative purposes, and audited (true) value <code>auditValue</code>.
Since the focus of this vignette is the evaluation stage in the audit,
the sample is already indicated in the data set. The performance
materiality in this example is set to 5 percent.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">allowances</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">allowances</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   item branch bookValue auditValue times</span></span>
<span><span class="co">## 1    1     12      1600       1600     1</span></span>
<span><span class="co">## 2    2     12      1625         NA     0</span></span>
<span><span class="co">## 3    3     12      1775         NA     0</span></span>
<span><span class="co">## 4    4     12      1250       1250     1</span></span>
<span><span class="co">## 5    5     12      1400         NA     0</span></span>
<span><span class="co">## 6    6     12      1190         NA     0</span></span></code></pre>
<div class="section level3">
<h3 id="non-stratified-samples-1">Non-stratified samples<a class="anchor" aria-label="anchor" href="#non-stratified-samples-1"></a>
</h3>
<p>Evaluating a non-stratified sample using data requires specification
of the <code>data</code>, <code>values</code> and
<code>values.audit</code> arguments. The input for these arguments is
the name of the specific column in <code>data</code>.</p>
<div class="section level4">
<h4 id="classical-evaluation-1">Classical evaluation<a class="anchor" aria-label="anchor" href="#classical-evaluation-1"></a>
</h4>
<p>The call below evaluates the <code>allowances</code> sample using a
classical non-stratified evaluation procedure.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, data <span class="op">=</span> <span class="va">allowances</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, times <span class="op">=</span> <span class="st">"times"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ &gt;= 0.05 vs. H₁: Θ &lt; 0.05 </span></span>
<span><span class="co">##   Method:                         poisson </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    1604 </span></span>
<span><span class="co">##   Number of errors:               401 </span></span>
<span><span class="co">##   Sum of taints:                  252.9281046 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Most likely error:              0.15769 </span></span>
<span><span class="co">##   95 percent confidence interval: [0, 0.175] </span></span>
<span><span class="co">##   Precision:                      0.017311 </span></span>
<span><span class="co">##   p-value:                        1</span></span></code></pre>
<p>In this case, the output shows that the estimate of the misstatement
in the population is 15.77 percent, with the 95 percent (one-sided)
confidence interval ranging from 0 percent to 17.5 percent.</p>
</div>
<div class="section level4">
<h4 id="bayesian-evaluation-1">Bayesian evaluation<a class="anchor" aria-label="anchor" href="#bayesian-evaluation-1"></a>
</h4>
<p>The call below evaluates the <code>allowances</code> sample using a
Bayesian non-stratified evaluation procedure.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, data <span class="op">=</span> <span class="va">allowances</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, times <span class="op">=</span> <span class="st">"times"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ &gt; 0.05 vs. H₁: Θ &lt; 0.05 </span></span>
<span><span class="co">##   Method:                         poisson </span></span>
<span><span class="co">##   Prior distribution:             gamma(α = 1, β = 1) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    1604 </span></span>
<span><span class="co">##   Number of errors:               401 </span></span>
<span><span class="co">##   Sum of taints:                  252.9281046 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         gamma(α = 253.928, β = 1605) </span></span>
<span><span class="co">##   Most likely error:              0.15759 </span></span>
<span><span class="co">##   95 percent credible interval:   [0, 0.17489] </span></span>
<span><span class="co">##   Precision:                      0.0173 </span></span>
<span><span class="co">##   BF₁₀:                            0</span></span></code></pre>
<p>The output shows that the estimate of the misstatement in the
population is 15.76 percent, with the 95 percent (one-sided) credible
interval ranging from 0 percent to 17.49 percent.</p>
</div>
</div>
<div class="section level3">
<h3 id="stratified-samples-1">Stratified samples<a class="anchor" aria-label="anchor" href="#stratified-samples-1"></a>
</h3>
<p>Evaluating a stratified sample using data requires specification of
the <code>data</code>, <code>values</code>, <code>values.audit</code>
and <code>strata</code> arguments in the <code><a href="../reference/evaluation.html">evaluation()</a></code>
function. In this case, the units are monetary and calculated by
aggregating the book values of the items in each stratum.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N.units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">allowances</span><span class="op">$</span><span class="va">bookValue</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">allowances</span><span class="op">$</span><span class="va">branch</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span><span class="op">$</span><span class="va">x</span></span></code></pre></div>
<div class="section level4">
<h4 id="classical-evaluation-2">Classical evaluation<a class="anchor" aria-label="anchor" href="#classical-evaluation-2"></a>
</h4>
<p>The call below evaluates the <code>allowances</code> sample using a
classical stratified evaluation procedure, in which the stratum
estimates are poststratified to arrive at the population estimate.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, data <span class="op">=</span> <span class="va">allowances</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, strata <span class="op">=</span> <span class="st">"branch"</span>, times <span class="op">=</span> <span class="st">"times"</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, N.units <span class="op">=</span> <span class="va">N.units</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Population size:                16772249 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ = 0.05 vs. H₁: Θ ≠ 0.05 </span></span>
<span><span class="co">##   Method:                         poisson </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    1604 </span></span>
<span><span class="co">##   Number of errors:               401 </span></span>
<span><span class="co">##   Sum of taints:                  252.9281046 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Most likely error:              0.14723 </span></span>
<span><span class="co">##   95 percent confidence interval: [0.12549, 0.18239] </span></span>
<span><span class="co">##   Precision:                      0.03516 </span></span>
<span><span class="co">##   p-value:                        NA </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata (16):</span></span>
<span><span class="co">##               N   n   x         t     mle      lb      ub precision p.value</span></span>
<span><span class="co">##   1   317200.09  87   6   1.27814 0.01469 0.00073 0.06950   0.05481 0.46285</span></span>
<span><span class="co">##   2  2792814.33 305 233 193.23313 0.63355 0.54558 0.72945   0.09590 0.00000</span></span>
<span><span class="co">##   3  1144231.69  55   3   3.00000 0.05455 0.01105 0.15940   0.10486 0.75827</span></span>
<span><span class="co">##   4   414202.89  70  45  15.05094 0.21501 0.11878 0.35434   0.13933 0.00000</span></span>
<span><span class="co">##   5    96660.53  18   1   0.64537 0.03585 0.00015 0.27456   0.23871 0.59343</span></span>
<span><span class="co">##   6   348006.13  34   1   0.17866 0.00525 0.00000 0.11926   0.11401 1.00000</span></span>
<span><span class="co">##   7  2384079.33  55  14   9.44448 0.17172 0.07885 0.32122   0.14950 0.00058</span></span>
<span><span class="co">##   8  1840399.33  96   1   0.00813 0.00008 0.00000 0.03860   0.03852 0.10355</span></span>
<span><span class="co">##   9   563957.70  92   0   0.00000 0.00000 0.00000 0.04010   0.04010 0.01783</span></span>
<span><span class="co">##   10 3198877.73 201   7   0.92023 0.00458 0.00009 0.02703   0.02245 0.00122</span></span>
<span><span class="co">##   11 1983299.06 128   7   1.50034 0.01172 0.00084 0.05013   0.03841 0.10773</span></span>
<span><span class="co">##   12  319144.13  86   5   1.68141 0.01955 0.00174 0.07806   0.05851 0.46069</span></span>
<span><span class="co">##   13  148905.79  25   0   0.00000 0.00000 0.00000 0.14756   0.14756 0.64187</span></span>
<span><span class="co">##   14  513058.76 150   0   0.00000 0.00000 0.00000 0.02459   0.02459 0.00134</span></span>
<span><span class="co">##   15  432007.61 150  39  21.80000 0.14533 0.09026 0.22045   0.07511 0.00001</span></span>
<span><span class="co">##   16  275403.70  52  39   4.18726 0.08052 0.02237 0.20215   0.12163 0.12258</span></span></code></pre>
<p>In this case, the output shows that the estimate of the misstatement
in the population is 14.72 percent, with the 95 percent confidence
interval ranging from 12.55 percent to 18.26 percent. The precision of
the population estimate is 3.54 percent. The stratum estimates can be
seen in the output of the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function and are
visualized below.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-20-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="bayesian-evaluation-2">Bayesian evaluation<a class="anchor" aria-label="anchor" href="#bayesian-evaluation-2"></a>
</h4>
<p>Bayesian inference can improve upon the estimates of the classical
approach by pooling information between strata where possible. The call
below evaluates the <code>allowances</code> sample using a Bayesian
stratified evaluation procedure, in which the stratum estimates are
poststratified to arrive at the population estimate.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="fl">0.05</span>, data <span class="op">=</span> <span class="va">allowances</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, strata <span class="op">=</span> <span class="st">"branch"</span>, times <span class="op">=</span> <span class="st">"times"</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, N.units <span class="op">=</span> <span class="va">N.units</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Population size:                16772249 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ = 0.05 vs. H₁: Θ ≠ 0.05 </span></span>
<span><span class="co">##   Method:                         poisson </span></span>
<span><span class="co">##   Prior distribution:             Nonparametric </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    1604 </span></span>
<span><span class="co">##   Number of errors:               401 </span></span>
<span><span class="co">##   Sum of taints:                  252.9281046 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         Nonparametric </span></span>
<span><span class="co">##   Most likely error:              0.1558 </span></span>
<span><span class="co">##   95 percent credible interval:   [0.13473, 0.1813] </span></span>
<span><span class="co">##   Precision:                      0.025505 </span></span>
<span><span class="co">##   BF₁₀:                            NaN </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata (16):</span></span>
<span><span class="co">##               N   n   x         t     mle      lb      ub precision</span></span>
<span><span class="co">##   1   317200.09  87   6   1.27814 0.01452 0.00380 0.06871   0.05419</span></span>
<span><span class="co">##   2  2792814.33 305 233 193.23313 0.63148 0.54862 0.72707   0.09559</span></span>
<span><span class="co">##   3  1144231.69  55   3   3.00000 0.05357 0.01946 0.15656   0.10299</span></span>
<span><span class="co">##   4   414202.89  70  45  15.05094 0.21199 0.12935 0.34935   0.13736</span></span>
<span><span class="co">##   5    96660.53  18   1   0.64537 0.03397 0.00749 0.26011   0.22614</span></span>
<span><span class="co">##   6   348006.13  34   1   0.17866 0.00510 0.00137 0.11585   0.11075</span></span>
<span><span class="co">##   7  2384079.33  55  14   9.44448 0.16865 0.09112 0.31548   0.14683</span></span>
<span><span class="co">##   8  1840399.33  96   1   0.00813 0.00008 0.00027 0.03821   0.03812</span></span>
<span><span class="co">##   9   563957.70  92   0   0.00000 0.00000 0.00027 0.03967   0.03967</span></span>
<span><span class="co">##   10 3198877.73 201   7   0.92023 0.00456 0.00108 0.02689   0.02234</span></span>
<span><span class="co">##   11 1983299.06 128   7   1.50034 0.01163 0.00322 0.04974   0.03811</span></span>
<span><span class="co">##   12  319144.13  86   5   1.68141 0.01933 0.00559 0.07716   0.05784</span></span>
<span><span class="co">##   13  148905.79  25   0   0.00000 0.00000 0.00097 0.14188   0.14188</span></span>
<span><span class="co">##   14  513058.76 150   0   0.00000 0.00000 0.00017 0.02443   0.02443</span></span>
<span><span class="co">##   15  432007.61 150  39  21.80000 0.14437 0.09550 0.21899   0.07462</span></span>
<span><span class="co">##   16  275403.70  52  39   4.18726 0.07900 0.03262 0.19834   0.11933</span></span></code></pre>
<p>The output shows that the estimate of the misstatement in the
population is 15.66 percent, with the 95 percent credible interval
ranging from 14.59 percent to 17 percent. The precision of the
population estimate is 1.34 percent, which is substantially lower than
that of the classical approach. The stratum estimates can be seen in the
output of the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function and are visualized
below.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"estimates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-22-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The prior and posterior distribution for the population misstatement
can be requested via the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-evaluation_files/figure-html/unnamed-chunk-23-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-derks_2021" class="csl-entry">
Derks, K., Swart, J. de, Batenburg, P. van, Wagenmakers, E.-J., &amp;
Wetzels, R. (2021). Priors in a <span>B</span>ayesian audit: How
integration of existing information into the prior distribution can
improve audit transparency and efficiency. <em>International Journal of
Auditing</em>, <em>25</em>(3), 621–636. <a href="https://doi.org/10.1111/ijau.12240" class="external-link">https://doi.org/10.1111/ijau.12240</a>
</div>
<div id="ref-derks_2021b" class="csl-entry">
Derks, K., Swart, J. de, Wagenmakers, E.-J., &amp; Wetzels, R. (2021).
The <span>B</span>ayesian approach to audit evidence: Quantifying
statistical evidence using the bayes factor. <em>PsyArXiv</em>. <a href="https://doi.org/10.31234/osf.io/kzqp5" class="external-link">https://doi.org/10.31234/osf.io/kzqp5</a>
</div>
<div id="ref-derks_2022" class="csl-entry">
Derks, K., Swart, J. de, Wagenmakers, E.-J., &amp; Wetzels, R. (2022a).
<em>An impartial <span>B</span>ayesian hypothesis test for audit
sampling</em>. <a href="https://doi.org/10.31234/osf.io/8nf3e" class="external-link">https://doi.org/10.31234/osf.io/8nf3e</a>
</div>
<div id="ref-derks_2022b" class="csl-entry">
Derks, K., Swart, J. de, Wagenmakers, E.-J., &amp; Wetzels, R. (2022b).
Bayesian generalized linear modeling for audit sampling: How to
incorporate audit information into the statistical model.
<em>PsyArXiv</em>. <a href="https://doi.org/10.31234/osf.io/byj2a" class="external-link">https://doi.org/10.31234/osf.io/byj2a</a>
</div>
<div id="ref-stewart_2012" class="csl-entry">
Stewart, T. R. (2012). <em>Technical notes on the <span>AICPA</span>
audit guide audit sampling</em>. American Institute of Certified Public
Accountants.
</div>
<div id="ref-stewart_2013" class="csl-entry">
Stewart, T. R. (2013). <em>A <span>B</span>ayesian audit assurance model
with application to the component materiality problem in group
audits</em> [PhD thesis, VU University]. <a href="https://hdl.handle.net/1871/39813" class="external-link">https://hdl.handle.net/1871/39813</a>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://koenderks.com" class="external-link">Koen Derks</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
