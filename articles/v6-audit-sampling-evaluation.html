<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Audit sampling: Evaluating a sample • jfa</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Audit sampling: Evaluating a sample">
<meta property="og:description" content="jfa">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/jfa.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v1-audit-sampling.html">Audit sampling: Get started</a>
    </li>
    <li>
      <a href="../articles/v2-audit-sampling-workflow.html">Audit sampling: Classical sampling workflow</a>
    </li>
    <li>
      <a href="../articles/v3-audit-sampling-bayesian-workflow.html">Audit sampling: Bayesian sampling workflow</a>
    </li>
    <li>
      <a href="../articles/v4-audit-sampling-prior-distributions.html">Audit sampling: Creating a prior distribution</a>
    </li>
    <li>
      <a href="../articles/v5-audit-sampling-sample-selection.html">Audit sampling: Selecting a sample</a>
    </li>
    <li>
      <a href="../articles/v6-audit-sampling-evaluation.html">Audit sampling: Evaluating a sample</a>
    </li>
    <li>
      <a href="../articles/v7-data-auditing.html">Data auditing: Get started</a>
    </li>
    <li>
      <a href="../articles/v8-auditing-data-digit-analysis.html">Auditing data: Digit analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/koenderks/jfa/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Audit sampling: Evaluating a sample</h1>
                        <h4 data-toc-skip class="author">Koen Derks</h4>
            
            <h4 data-toc-skip class="date">last modified:
05-11-2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/koenderks/jfa/blob/HEAD/vignettes/v6-audit-sampling-evaluation.Rmd" class="external-link"><code>vignettes/v6-audit-sampling-evaluation.Rmd</code></a></small>
      <div class="hidden name"><code>v6-audit-sampling-evaluation.Rmd</code></div>

    </div>

    
    
<p>This vignette outlines the most commonly used sample evaluation
methodology for auditing and shows how to evaluate a sample using these
methods with the <code>jfa</code> package.</p>
<div class="section level3">
<h3 id="hypothesis-testing">Hypothesis testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h3>
<p>In an audit sampling test the auditor generally assigns performance
materiality, <span class="math inline">\(\theta_{max}\)</span>, to the
population which expresses the maximum tolerable misstatement (as a
fraction or a monetary amount). The auditor then inspects a sample of
the population to make a decision between the following two
hypotheses:</p>
<p><span class="math display">\[H_1:\theta&lt;\theta_{max}\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,
H_0:\theta\geq\theta_{max}\]</span>.</p>
<p>The <code><a href="../reference/evaluation.html">evaluation()</a></code> function allows you to make a statement
about the credibility of these two hypotheses after inspecting a sample.
Note that this requires that you specify the <code>materiality</code>
argument in the function.</p>
<div class="section level4">
<h4 id="classical-hypothesis-testing-using-the-p-value">Classical hypothesis testing using the <em>p</em>-value<a class="anchor" aria-label="anchor" href="#classical-hypothesis-testing-using-the-p-value"></a>
</h4>
<p>Classical hypothesis testing uses the <em>p</em> value to make a
decision about whether to reject the hypothesis <span class="math inline">\(H_0\)</span> or not. As an example, consider that
an auditor wants to verify whether the population contains less than 5
percent misstatement, implying the hypotheses <span class="math inline">\(H_1:\theta&lt;0.05\)</span> and <span class="math inline">\(H_0:\theta\geq0.05\)</span>. They have taken a
sample of 100 items, of which 1 contained an error. They set the
significance level for the <em>p</em> value to 0.05, implying that a
<em>p</em> value &lt; 0.05 will be enough to reject the hypothesis <span class="math inline">\(H_0\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_classical</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_classical</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ &gt;= 0.05 vs. H₁: Θ &lt; 0.05 </span></span>
<span><span class="co">##   Method:                         poisson </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    100 </span></span>
<span><span class="co">##   Number of errors:               1 </span></span>
<span><span class="co">##   Sum of taints:                  1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Most likely error:              0.01 </span></span>
<span><span class="co">##   95 percent confidence interval: [0, 0.047439] </span></span>
<span><span class="co">##   Precision:                      0.037439 </span></span>
<span><span class="co">##   p-value:                        0.040428</span></span></code></pre>
<p>As we can see, the <em>p</em> value is lower than 0.05 implying that
the hypothesis <span class="math inline">\(H_0\)</span> is rejected.</p>
</div>
<div class="section level4">
<h4 id="bayesian-hypothesis-testing-using-the-bayes-factor">Bayesian hypothesis testing using the Bayes factor<a class="anchor" aria-label="anchor" href="#bayesian-hypothesis-testing-using-the-bayes-factor"></a>
</h4>
<p>Bayesian hypothesis testing uses the Bayes factor, <span class="math inline">\(BF_{10}\)</span> or <span class="math inline">\(BF_{01}\)</span>, to make a statement about the
evidence provided by the sample in support for one of the two hypotheses
<span class="math inline">\(H_1\)</span> or <span class="math inline">\(H_0\)</span>. The subscript The Bayes factor
denotes which hypothesis it favors. By default, the
<code><a href="../reference/evaluation.html">evaluation()</a></code> function returns the value for <span class="math inline">\(BF_{10}\)</span>.</p>
<p>As an example of how to interpret the Bayes factor, the value of
<span class="math inline">\(BF_{10} = 10\)</span> (provided by the
<code><a href="../reference/evaluation.html">evaluation()</a></code> function) can be interpreted as: <em>the data
are 10 times more likely to have occurred under the hypothesis <span class="math inline">\(H_1:\theta&lt;\theta_{max}\)</span> than under the
hypothesis <span class="math inline">\(H_0:\theta\geq\theta_{max}\)</span></em>. <span class="math inline">\(BF_{10} &gt; 1\)</span> indicates evidence for
<span class="math inline">\(H_1\)</span>, while <span class="math inline">\(BF_{10} &lt; 1\)</span> indicates evidence for
<span class="math inline">\(H_0\)</span>.</p>
<table class="table">
<thead><tr class="header">
<th><span class="math inline">\(BF_{10}\)</span></th>
<th>Strength of evidence</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(&lt; 0.01\)</span></td>
<td>Extreme evidence for <span class="math inline">\(H_0\)</span>
</td>
</tr>
<tr class="even">
<td><span class="math inline">\(0.01 - 0.033\)</span></td>
<td>Very strong evidence for <span class="math inline">\(H_0\)</span>
</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0.033 - 0.10\)</span></td>
<td>Strong evidence for <span class="math inline">\(H_0\)</span>
</td>
</tr>
<tr class="even">
<td><span class="math inline">\(0.10 - 0.33\)</span></td>
<td>Moderate evidence for <span class="math inline">\(H_0\)</span>
</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0.33 - 1\)</span></td>
<td>Anecdotal evidence for <span class="math inline">\(H_0\)</span>
</td>
</tr>
<tr class="even">
<td><span class="math inline">\(1\)</span></td>
<td>No evidence for <span class="math inline">\(H_1\)</span> or <span class="math inline">\(H_0\)</span>
</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(1 - 3\)</span></td>
<td>Anecdotal evidence for <span class="math inline">\(H_1\)</span>
</td>
</tr>
<tr class="even">
<td><span class="math inline">\(3 - 10\)</span></td>
<td>Moderate evidence for <span class="math inline">\(H_1\)</span>
</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(10 - 30\)</span></td>
<td>Strong evidence for <span class="math inline">\(H_1\)</span>
</td>
</tr>
<tr class="even">
<td><span class="math inline">\(30 - 100\)</span></td>
<td>Very strong evidence for <span class="math inline">\(H_1\)</span>
</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(&gt; 100\)</span></td>
<td>Extreme evidence for <span class="math inline">\(H_1\)</span>
</td>
</tr>
</tbody>
</table>
<div class="section level5">
<h5 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h5>
<p>Again, consider the same example of an auditor who wants to verify
whether the population contains less than 5 percent misstatement,
implying the hypotheses <span class="math inline">\(H_1:\theta&lt;0.05\)</span> and <span class="math inline">\(H_0:\theta\geq0.05\)</span>. They have taken a
sample of 100 items, of which 1 contained an error. The prior
distribution is assumed to be a default <em>beta(1,1)</em> prior.</p>
<p>The output below shows that <span class="math inline">\(BF_{10}=515\)</span>, implying that there is
extreme evidence for <span class="math inline">\(H_1\)</span>, the
hypothesis that the population contains misstatements lower than 5
percent of the population.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auditPrior.html">auditPrior</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"default"</span>, likelihood <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="va">result_bayesian</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">100</span>, prior <span class="op">=</span> <span class="va">prior</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using 'method = binomial' from 'prior'</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_bayesian</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ &gt; 0.05 vs. H₁: Θ &lt; 0.05 </span></span>
<span><span class="co">##   Method:                         binomial </span></span>
<span><span class="co">##   Prior distribution:             beta(α = 1, β = 1) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    100 </span></span>
<span><span class="co">##   Number of errors:               1 </span></span>
<span><span class="co">##   Sum of taints:                  1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         beta(α = 2, β = 100) </span></span>
<span><span class="co">##   Most likely error:              0.01 </span></span>
<span><span class="co">##   95 percent credible interval:   [0, 0.046107] </span></span>
<span><span class="co">##   Precision:                      0.036107 </span></span>
<span><span class="co">##   BF₁₀:                            515.86</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="sensitivity-to-the-prior-distribution">Sensitivity to the prior distribution<a class="anchor" aria-label="anchor" href="#sensitivity-to-the-prior-distribution"></a>
</h5>
<p>In audit sampling, the Bayes factor is dependent on the prior
distribution for <span class="math inline">\(\theta\)</span>. As a rule
of thumb, when the prior distribution is very uninformative (as with
<code>method = 'default'</code>) with respect to <span class="math inline">\(\theta\)</span>, the Bayes factor tends to
overquantify the evidence in favor of <span class="math inline">\(H_1\)</span>. You can mitigate this dependency
using <code>method = "impartial"</code> in the <code><a href="../reference/auditPrior.html">auditPrior()</a></code>
function, which constructs a prior distribution that is impartial with
respect to the hypotheses <span class="math inline">\(H_1\)</span> and
<span class="math inline">\(H_0\)</span>.</p>
<p>The output below shows that <span class="math inline">\(BF_{10}=47\)</span>, implying that there is strong
evidence for <span class="math inline">\(H_1\)</span>, the hypothesis
that the population contains misstatements lower than 5 percent of the
population. Since the two priors both resulted in convincing Bayes
factors, the results are robust to the choice of prior distribution.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auditPrior.html">auditPrior</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"impartial"</span>, likelihood <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="va">result_bayesian</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.05</span>, x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">100</span>, prior <span class="op">=</span> <span class="va">prior</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using 'method = binomial' from 'prior'</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_bayesian</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ &gt; 0.05 vs. H₁: Θ &lt; 0.05 </span></span>
<span><span class="co">##   Method:                         binomial </span></span>
<span><span class="co">##   Prior distribution:             beta(α = 1, β = 13.513) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    100 </span></span>
<span><span class="co">##   Number of errors:               1 </span></span>
<span><span class="co">##   Sum of taints:                  1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         beta(α = 2, β = 112.513) </span></span>
<span><span class="co">##   Most likely error:              0.0088878 </span></span>
<span><span class="co">##   95 percent credible interval:   [0, 0.041108] </span></span>
<span><span class="co">##   Precision:                      0.03222 </span></span>
<span><span class="co">##   BF₁₀:                            47.435</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="application">Application<a class="anchor" aria-label="anchor" href="#application"></a>
</h5>
<p>Two-stage sampling plans are required if an initial sample does not
provide enough assurance to accept (or reject) a population
definitively. In the field of quality control, ISO 28596 ‘Sampling
procedures for inspection by attributes — Two-stage sampling plans for
auditing and for inspection under prior information’ provides two-stage
sampling plans by attributes for inspection for a proportion of
nonconforming items in a target population of discrete units. For
example, this standard applies for inspections of a proportion of
nonconforming items in a lot of product items, or inspections of the
proportion of nonconforming test characteristics of a product subject to
an acceptance test.</p>
<p>The idea behind the standard two-stage sampling plan is simple. In
the first stage, after drawing <span class="math inline">\(n_1\)</span>
items and observing <span class="math inline">\(k_1\)</span>
nonconforming items, a confidence interval for the proportion of
nonconforming items is calculated. The decision in the first stage
proceeds according to one of the three following scenarios:</p>
<ol style="list-style-type: decimal">
<li>If the confidence interval completely lies below the tolerance
value, the lot is accepted.</li>
<li>If the confidence interval completely lies above the tolerance
value, the lot is rejected.</li>
<li>If the confidence interval contains the tolerance value, no decision
can be made in the first stage. In this case, the auditor proceeds to
the second stage.</li>
</ol>
<p>In the second stage, a number <span class="math inline">\(k_2\)</span> of nonconforming items is observed in
a sample of size <span class="math inline">\(n_2\)</span>. A new
confidence interval for the proportion of nonconforming items is
calculated based on the total number <span class="math inline">\(k_1 +
k_2\)</span> of nonconforming items. The decision in the second stage
proceeds according to one of the two following scenarios:</p>
<ol style="list-style-type: decimal">
<li>If the confidence interval completely lies above or below the
tolerance value, the decision for approval and rejection is analogous to
that in the first stage.</li>
<li>If the interval contains the tolerance value, the decision is based
on whether a bigger portion of the confidence interval lies below or
above the tolerance value. If a larger portion of the interval lies
above the tolerance value, the lot is rejected. If a larger portion of
the interval lies below the tolerance value, the lot is accepted.</li>
</ol>
<p>The auditor is inspecting a lot of products and wants to make a
statement with 90% confidence against a tolerance value of 5%. They
formulate the hypothesis of intolerable deviations as <span class="math inline">\(H_0:\theta \geq 0.05\)</span> and the hypothesis
of tolerable deviations as <span class="math inline">\(H_1: \theta &lt;
0.05\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">confidence</span> <span class="op">&lt;-</span> <span class="fl">0.90</span> <span class="co"># 90% confidence</span></span>
<span><span class="va">tolerance</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="co"># 5% tolerance</span></span></code></pre></div>
<p>In the first stage, the auditor inspects <span class="math inline">\(n_1 = 32\)</span> items and observes <span class="math inline">\(k_1 = 2\)</span> nonconforming items. The shortest
two-sided confidence interval (Göb &amp; Lurz, 2012) for the proportion
of nonconforming items is [0.0167; 0.1866]. This confidence interval
contains the tolerance value and therefore no decision can be made in
the first stage. The auditor therefore continues to the second
stage.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ISO28596</span><span class="fu">:::</span><span class="fu">CI.binom.shortest</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">32</span>, x <span class="op">=</span> <span class="fl">2</span>, level <span class="op">=</span> <span class="va">confidence</span><span class="op">)</span><span class="op">$</span><span class="va">bounds</span></span>
<span><span class="co">#      x estimate      lower     upper</span></span>
<span><span class="co"># [1,] 2   0.0625 0.01674365 0.1866428</span></span></code></pre></div>
<p>In the second stage, the auditor inspects an additional <span class="math inline">\(n_2 = 50\)</span> items and observes <span class="math inline">\(k_2 = 0\)</span> nonconforming items. After
observing these data, the shortest two-sided confidence interval for the
proportion of nonconforming items (using <span class="math inline">\(n =
n_1 + n_2\)</span> and <span class="math inline">\(k = k_1 +
k_2\)</span>) is [0.0065; 0.0734]. At this point, the confidence
interval still contains the tolerance value but the auditor determines
that the portion of the confidence interval that lies below the
tolerance value is larger than the portion above the tolerance value.
Therefore, they accept the lot.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ISO28596</span><span class="fu">:::</span><span class="fu">CI.binom.shortest</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">32</span> <span class="op">+</span> <span class="fl">50</span>, x <span class="op">=</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">0</span>, level <span class="op">=</span> <span class="va">confidence</span><span class="op">)</span><span class="op">$</span><span class="va">bounds</span></span>
<span><span class="co">#      x   estimate       lower      upper</span></span>
<span><span class="co"># [1,] 2 0.02439024 0.006504196 0.07341118</span></span></code></pre></div>
<p>The <code>jfa</code> package can be used to calculate Bayes factors
for the hypothesis of tolerable deviations <span class="math inline">\(H_1\)</span> in the lot versus the hypothesis of
intolerable deviations <span class="math inline">\(H_0\)</span> in the
lot. The Bayes factor can provide insight into the weight of evidence in
favor of acceptance of the lot versus the evidence in favor of rejection
of the lot. Especially in the situation where the confidence interval
contains the tolerance value the Bayes factor can provide an easy
interpretation of the evidence in favor of acceptance versus
rejection.</p>
<p><span class="math display">\[BF_{10} =
\underbrace{\frac{p(\text{data} | H_1)}{p(\text{data} |
H_0)}}_{\text{Relative evidence}} \]</span></p>
<p>To calculate the Bayes factor the auditor must first specify the
prior distribution for the proportion of nonconforming items in the lot.
An appropriate prior distribution can be one that assigns equal
probability to the event of acceptance and the event of rejection (Derks
et al., 2021), see also the vignette <a href="https://koenderks.github.io/jfa/articles/v3_prior_distributions.html" class="external-link">Prior
distributions</a>. The code below creates this prior distribution.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auditPrior.html">auditPrior</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"impartial"</span>, likelihood <span class="op">=</span> <span class="st">"binomial"</span>, materiality <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p>Using the <code><a href="../reference/evaluation.html">evaluation()</a></code> function the auditor can create
the prior distribution and calculate the Bayes factor in favor of
acceptance of the lot versus rejection of the lot. In this case, the
Bayes factor in favor of acceptance (<span class="math inline">\(BF_{-+}\)</span>) is 0.66. This Bayes factor
represents only anecdotal evidence in favor of rejection of the lot,
since the data is 1 / 0.66 = 1.51 times more likely under the hypothesis
<span class="math inline">\(H_0\)</span> than under the hypothesis <span class="math inline">\(H_1\)</span> (see the vignette <a href="https://koenderks.github.io/jfa/articles/v6_testing_misstatement.html" class="external-link">Testing
misstatement</a> for the interpretation of <span class="math inline">\(BF_{-+}\)</span>).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="va">tolerance</span>, x <span class="op">=</span> <span class="fl">2</span>, n <span class="op">=</span> <span class="fl">32</span>, prior <span class="op">=</span> <span class="va">prior</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using 'method = binomial' from 'prior'</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  2 and 32</span></span>
<span><span class="co">## number of errors = 2, number of samples = 32, taint = 2, BF₁₀ = 0.66487</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.05</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.0000000 0.1319424</span></span>
<span><span class="co">## estimate:</span></span>
<span><span class="co">##  0.04493028 </span></span>
<span><span class="co">## estimates obtained via method 'binomial' + 'prior'</span></span></code></pre>
<p>The Bayes factor in favor of acceptance after the second sample of
items is 6.24 which represents moderate evidence in favor of acceptance.
Hence, we should continue selecting and inspecting items to gather
sufficient evidence for one of the two hypotheses.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="va">tolerance</span>, x <span class="op">=</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">0</span>, n <span class="op">=</span> <span class="fl">32</span> <span class="op">+</span> <span class="fl">50</span>, prior <span class="op">=</span> <span class="va">prior</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using 'method = binomial' from 'prior'</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  2 and 82</span></span>
<span><span class="co">## number of errors = 2, number of samples = 82, taint = 2, BF₁₀ = 6.2413</span></span>
<span><span class="co">## alternative hypothesis: true misstatement rate is less than 0.05</span></span>
<span><span class="co">## 95 percent credible interval:</span></span>
<span><span class="co">##  0.00000000 0.06444852</span></span>
<span><span class="co">## estimate:</span></span>
<span><span class="co">##  0.02116102 </span></span>
<span><span class="co">## estimates obtained via method 'binomial' + 'prior'</span></span></code></pre>
</div>
</div>
</div>
<div class="section level3">
<h3 id="estimation">Estimation<a class="anchor" aria-label="anchor" href="#estimation"></a>
</h3>
<p>When performing estimation the auditor tries to determine the unknown
misstatement in the population on the basis of a sample. Generally,
estimation implies that there is a minimal amount of assurance to be
obtained about the precision / accuracy of your estimate (i.e., the most
likely error - the upper bound). This inference about the population
misstatement can be performed using the <code><a href="../reference/evaluation.html">evaluation()</a></code>
function by specifying the <code>min.precision</code> argument and
providing the sample data or summary statistics.</p>
<div class="section level4">
<h4 id="classical-estimation">Classical estimation<a class="anchor" aria-label="anchor" href="#classical-estimation"></a>
</h4>
<p>Suppose your sampling objective is to estimate the misstatement with
a precision of 2%. You have planned a sample of <em>n</em> = 188 items
from which <em>x</em> = 1 turns out a contain an error. Standard
classical evaluation using the Poisson distribution can be performed
using the example code below.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_classical</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>min.precision <span class="op">=</span> <span class="fl">0.02</span>, method <span class="op">=</span> <span class="st">"poisson"</span>, n <span class="op">=</span> <span class="fl">188</span>, x <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Calling the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function on the result from the
<code><a href="../reference/evaluation.html">evaluation()</a></code> function provides the estimates for the most
likely error, the 95% upper bound, and the precision.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_classical</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Classical Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Min. precision:                 0.02 </span></span>
<span><span class="co">##   Method:                         poisson </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    188 </span></span>
<span><span class="co">##   Number of errors:               1 </span></span>
<span><span class="co">##   Sum of taints:                  1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Most likely error:              0.0053191 </span></span>
<span><span class="co">##   95 percent confidence interval: [0, 0.025233] </span></span>
<span><span class="co">##   Precision:                      0.019914</span></span></code></pre>
<p>As we can see, the most likely error in the population is 1 / 188 =
0.53% and the 95% (one-sided) confidence interval ranges from 0% to
2.52%. Consequently, the precision of the estimate is 2.52% - 0.53% =
1.99%. This means that this sample provides sufficient information to
estimate the misstatement in the population with a precision of 2%.</p>
</div>
<div class="section level4">
<h4 id="bayesian-estimation">Bayesian estimation<a class="anchor" aria-label="anchor" href="#bayesian-estimation"></a>
</h4>
<p>In principle Bayesian estimation follows the same procedure as its
classical counterpart, with the exception that a prior distribution must
be provided to the <code><a href="../reference/evaluation.html">evaluation()</a></code> function. Therefore, the
first step is to set up a prior distribution (see also the vignette <a href="https://koenderks.github.io/jfa/articles/v3_prior_distributions.html" class="external-link">Prior
distributions</a>). For illustration, we will assume a
<code>default</code> <em>gamma(1, 1)</em> prior distribution.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auditPrior.html">auditPrior</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"default"</span>, likelihood <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span></code></pre></div>
<p>The sample outcomes together with the prior distribution can then be
provided to the evaluation function. Once again, the
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function provides the estimates for the most
likely error, the 95% upper bound, and the precision. Note that, because
the prior is already constructed for use with a <code>poisson</code>
likelihood, the <code>method</code> argument does not need to be
provided to the <code><a href="../reference/evaluation.html">evaluation()</a></code> function.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_bayesian</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span>min.precision <span class="op">=</span> <span class="fl">0.02</span>, n <span class="op">=</span> <span class="fl">188</span>, x <span class="op">=</span> <span class="fl">1</span>, prior <span class="op">=</span> <span class="va">prior</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_bayesian</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Min. precision:                 0.02 </span></span>
<span><span class="co">##   Method:                         poisson </span></span>
<span><span class="co">##   Prior distribution:             gamma(α = 1, β = 1) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    188 </span></span>
<span><span class="co">##   Number of errors:               1 </span></span>
<span><span class="co">##   Sum of taints:                  1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         gamma(α = 2, β = 189) </span></span>
<span><span class="co">##   Most likely error:              0.005291 </span></span>
<span><span class="co">##   95 percent credible interval:   [0, 0.0251] </span></span>
<span><span class="co">##   Precision:                      0.019809</span></span></code></pre>
<p>As we can see, the posterior distribution is a <em>gamma(2, 189)</em>
distribution. This distribution implies a most likely error in the
population is 0.53% and a 95% (one-sided) confidence interval that
ranges from 0% to 2.51%. Consequently, the precision of the estimate is
2.51% - 0.53% = 1.98%. Also in the Bayesian framework, this sample
provides sufficient information to estimate the misstatement in the
population with a precision of 2%.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Derks, K., de Swart, J., van Batenburg, P., Wagenmakers, E.-J.,
and Wetzels, R. (2021). Priors in a Bayesian audit: How integration of
existing information into the prior distribution can improve audit
transparency and efficiency. <em>International Journal of Auditing</em>,
25(3), 621-636.</p></li>
<li><p>Derks, K., de Swart, J., Wagenmakers, E.-J., &amp; Wetzels, R.
(2021). The Bayesian Approach to Audit Evidence: Quantifying Statistical
Evidence using the Bayes Factor. <em>PsyArXiv</em>.</p></li>
<li><p>Stewart, T. R. (2012). <em>Technical Notes on the AICPA Audit
Guide Audit Sampling</em>. American Institute of Certified Public
Accountants, New York.</p></li>
<li><p>Stewart, T. R. (2013). <em>A Bayesian Audit Assurance Model with
Application to the Component Materiality problem in Group Audits.</em>
VU University, Amsterdam.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Koen Derks.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
