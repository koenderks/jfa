<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Walkthrough of the Bayesian audit sampling workflow • jfa</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Walkthrough of the Bayesian audit sampling workflow">
<meta property="og:description" content="jfa">
<meta property="og:image" content="https://koenderks.github.io/jfa/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/jfa.html">Get started</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/koenderks/jfa" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/koenderks/jfa/discussions" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Walkthrough of the Bayesian audit sampling
workflow</h1>
                        <h4 data-toc-skip class="author">Koen Derks</h4>
            
            <h4 data-toc-skip class="date">2023-08-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/koenderks/jfa/blob/HEAD/vignettes/bayesian-sampling-workflow.Rmd" class="external-link"><code>vignettes/bayesian-sampling-workflow.Rmd</code></a></small>
      <div class="hidden name"><code>bayesian-sampling-workflow.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette aims to show how the <strong>jfa</strong> package
facilitates auditors in the standard audit sampling workflow (hereafter
“audit workflow”). In this example of the audit workflow, we will
consider the case of BuildIt. BuildIt is a fictional construction
company in the United States that is being audited by an external
auditor for a fictional audit firm. At the end of the year, BuildIt has
provided a summary of its financial situation in the financial
statements. The objective of the auditor is to formulate an opinion
about the fairness BuildIt’s financial statements.</p>
<p>The auditor needs to obtain sufficient and appropriate evidence for
the hypothesis that the misstatement in the financial statements is
lower than a certain amount: the materiality. If the financial
statements contain misstatements that are considered material, this
means that the errors in the financial statements are large enough that
they might influence the decision of stakeholders relying on these
financial statements. The performance materiality is the materiality
that applies to each of the populations on which the financial
statements are based. For this example, the performance materiality is
set at 5% of the total value of the population.</p>
<p>In this example, we focus on the <code>BuildIt</code> data set that
comes with the <strong>jfa</strong> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"BuildIt"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      ID bookValue auditValue</span></span>
<span><span class="co">## 1 82884    242.61     242.61</span></span>
<span><span class="co">## 2 25064    642.99     642.99</span></span>
<span><span class="co">## 3 81235    628.53     628.53</span></span>
<span><span class="co">## 4 71769    431.87     431.87</span></span>
<span><span class="co">## 5 55080    620.88     620.88</span></span>
<span><span class="co">## 6 93224    501.76     501.76</span></span></code></pre>
<p>The population of interest consists of 3500 items, each with a booked
value. Let’s assume that, before performing audit sampling, the auditor
has assessed the quality of BuildIt’s internal control systems and found
that they were working properly.</p>
<p>In order to formulate an opinion about the misstatement in the
population, the auditor separates their audit workflow into four stages.
First, they will need to plan the minimum size of a sample they need to
inspect to perform inference about the population. Second, they will
need to select the required sample from the population. Third, they will
need to inspect the selected sample and determine the audit (true) value
of the items it contains. Fourth, they will need to use the information
from the inspected sample to perform inference about the misstatement in
the population.</p>
<p align="center">
<img src="workflow.png" alt="workflow" width="100%"></p>
</div>
<div class="section level2">
<h2 id="setting-up-the-audit">Setting up the audit<a class="anchor" aria-label="anchor" href="#setting-up-the-audit"></a>
</h2>
<p>The auditor wants to make a statement that, with 95% confidence, the
misstatement in the population is lower than the performance materiality
of 5%. Based on last year’s audit at BuildIt, where the upper bound of
the misstatement turned out to be 2.5%, they want to tolerate at most
2.5% errors in the intended sample. The auditor can therefore
re-formulate their statistical statement as that they want to conclude
that, when 2.5% errors are found in the sample, they can conclude with
95% confidence that the misstatement in the population is lower than the
performance materiality of 5%.</p>
<p>Below, the auditor defines the performance materiality, confidence
level, and expected misstatements in the sample.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the confidence, materiality, and expected misstatements.</span></span>
<span><span class="va">confidence</span> <span class="op">&lt;-</span> <span class="fl">0.95</span> <span class="co"># 95%</span></span>
<span><span class="va">materiality</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="co"># 5%</span></span>
<span><span class="va">expected</span> <span class="op">&lt;-</span> <span class="fl">0.025</span> <span class="co"># 2.5%</span></span></code></pre></div>
<p>Many audits are performed according to the <em>audit risk model
(ARM)</em>, which determines that the uncertainty about the auditor’s
statement as a whole (1 - the confidence) is a factor of three terms:
the inherent risk, the control risk, and the detection risk. Inherent
risk is the risk posed by an error in BuildIt’s financial statement that
could be material, before consideration of any related control systems
(e.g., computer systems). Control risk is the risk that a material
misstatement is not prevented or detected by BuildIt’s internal control
systems. Detection risk is the risk that the auditor will fail to find
material misstatements that exist in an BuildIt’s financial statements.
The <em>ARM</em> is practically useful because for a given level of
audit risk, the tolerable detection risk bears an inverse relation to
the other two risks. The <em>ARM</em> is useful for the auditor because
it enables them to incorporate existing information on BuildIt’s
organization to increase the required risk that they will fail to find a
material misstatement.</p>
<p><span class="math display">\[ \text{Audit risk} = \text{Inherent
risk} \,\times\, \text{Control risk} \,\times\, \text{Detection
risk}\]</span></p>
<p>Usually the auditor judges inherent risk and control risk on a
three-point scale consisting of low, medium, and high. Different audit
firms handle different standard percentages for these categories. The
auditor’s firm defines the probabilities of low, medium, and high
respectively as 50%, 60%, and 100%. Because the auditor assessed
BuildIt’s internal control systems, they assess the control risk as
medium (60%).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the inherent risk (ir) and control risk (cr).</span></span>
<span><span class="va">ir</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># 100%</span></span>
<span><span class="va">cr</span> <span class="op">&lt;-</span> <span class="fl">0.6</span> <span class="co"># 60%</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="stage-1-planning-an-audit-sample">Stage 1: Planning an audit sample<a class="anchor" aria-label="anchor" href="#stage-1-planning-an-audit-sample"></a>
</h2>
<p align="center">
<img src="planning.png" alt="planning" width="100%"></p>
<p>The auditor can choose to either perform a frequentist analysis,
where they use the increased detection risk as their level of
uncertainty, or perform a Bayesian analysis, where they incorporate the
information about the control risk into a prior distribution. For this
example, we will show how to perform a Bayesian analysis. A frequentist
analysis can easily be done through the following functions by setting
<code>prior = FALSE</code>. In a frequentist analysis, the auditor uses
the value <code>c.adj</code> as their new value for
<code>confidence</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adjust the required confidence for a frequentist analysis.</span></span>
<span><span class="va">c.adj</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">confidence</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">ir</span> <span class="op">*</span> <span class="va">cr</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>However, in a Bayesian audit, the auditor starts at step 0 by
defining the prior distribution that corresponds to their assessment of
the control risk. Using the <code><a href="../reference/auditPrior.html">auditPrior()</a></code> function, they can
create a prior distribution that incorporates the information in the
risk assessments from the <em>ARM</em>. For more information on how this
is done, see Derks et al. (2019).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 0: Create a prior distribution according to the audit risk model.</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auditPrior.html">auditPrior</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"arm"</span>, likelihood <span class="op">=</span> <span class="st">"poisson"</span>, expected <span class="op">=</span> <span class="va">expected</span>,</span>
<span>  materiality <span class="op">=</span> <span class="va">materiality</span>, ir <span class="op">=</span> <span class="va">ir</span>, cr <span class="op">=</span> <span class="va">cr</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The prior distribution can be shown by using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">prior</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayesian-sampling-workflow_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Now that the prior distribution is specified, the auditor can
calculate the required sample size for their desired inference by using
the <code><a href="../reference/planning.html">planning()</a></code> function. They uses the <code>prior</code>
object as input for the <code><a href="../reference/planning.html">planning()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 1: Calculate the required sample size.</span></span>
<span><span class="va">stage1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/planning.html">planning</a></span><span class="op">(</span>materiality <span class="op">=</span> <span class="va">materiality</span>, expected <span class="op">=</span> <span class="va">expected</span>, conf.level <span class="op">=</span> <span class="va">confidence</span>, prior <span class="op">=</span> <span class="va">prior</span><span class="op">)</span></span></code></pre></div>
<p>The auditor can then inspect the result from her planning procedure
by using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function. The result show that,
given the prior distribution, the auditor needs to select a sample of
178 items so that, when at most 4.45 misstatements are found, they can
conclude with 95% confidence that the misstatement in BuildIt’s
financial statements is lower the performance materiality of 5%.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">stage1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Planning Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:              0.95 </span></span>
<span><span class="co">##   Materiality:                   0.05 </span></span>
<span><span class="co">##   Hypotheses:                    H₀: Θ &gt; 0.05 vs. H₁: Θ &lt; 0.05 </span></span>
<span><span class="co">##   Expected:                      0.025 </span></span>
<span><span class="co">##   Likelihood:                    poisson </span></span>
<span><span class="co">##   Prior distribution:            gamma(α = 2.325, β = 53) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Minimum sample size:           178 </span></span>
<span><span class="co">##   Tolerable errors:              4.45 </span></span>
<span><span class="co">##   Posterior distribution:        gamma(α = 6.775, β = 231) </span></span>
<span><span class="co">##   Expected most likely error:    0.025 </span></span>
<span><span class="co">##   Expected upper bound:          0.049981 </span></span>
<span><span class="co">##   Expected precision:            0.024981 </span></span>
<span><span class="co">##   Expected BF₁₀:                 9.6614</span></span></code></pre>
<p>The auditor can inspect how the prior distribution compares to the
expected posterior distribution by using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
function. The expected posterior distribution is the posterior
distribution that would occur if the auditor actually observed a sample
of 178 items, from which 4.45 were misstated.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stage1</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayesian-sampling-workflow_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="stage-2-selecting-a-sample">Stage 2: Selecting a sample<a class="anchor" aria-label="anchor" href="#stage-2-selecting-a-sample"></a>
</h2>
<p align="center">
<img src="selection.png" alt="selection" width="100%"></p>
<p>The auditor is now ready to select the required 178 items from the
population. They can choose to do this according to one of two
statistical methods. In <em>record sampling</em>
(<code>units = "items"</code>), inclusion probabilities are assigned on
the item level, treating item with a high value and a low value the
same, an item of $5,000 is equally likely to be selected as an item of
$1,000. In <em>monetary unit sampling</em>
(<code>units = "values"</code>), inclusion probabilities are assigned on
the level of individual monetary units (e.g., a dollar). When a dollar
is selected to be in the sample, the item that includes that dollar is
selected. This favors items with a higher value, as an item with a value
of $5,000 is now five times more likely to be selected than an item with
a value of $1,000.</p>
<p>The auditor chooses to use <em>monetary unit sampling</em>, as they
wants to include more high-valued items. The <code><a href="../reference/selection.html">selection()</a></code>
function enables them to select the sample from the population. She uses
the <code>stage1</code> object as an input for the
<code><a href="../reference/selection.html">selection()</a></code> function, since this passes the calculated
sample size to the function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 2: Draw a sample from the financial statements.</span></span>
<span><span class="va">stage2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selection.html">selection</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="va">stage1</span>, units <span class="op">=</span> <span class="st">"values"</span>, values <span class="op">=</span> <span class="st">"bookValue"</span>, method <span class="op">=</span> <span class="st">"interval"</span><span class="op">)</span></span></code></pre></div>
<p>Like before, the auditor can inspect the outcomes of their sampling
procedure<br>
by using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">stage2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Audit Sample Selection Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Requested sample size:         178 </span></span>
<span><span class="co">##   Sampling units:                monetary units </span></span>
<span><span class="co">##   Method:                        fixed interval sampling </span></span>
<span><span class="co">##   Starting point:                1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Population size:               3500 </span></span>
<span><span class="co">##   Population value:              1403221 </span></span>
<span><span class="co">##   Selection interval:            7883.3 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Selected sampling units:       178 </span></span>
<span><span class="co">##   Proportion of value:           0.062843 </span></span>
<span><span class="co">##   Selected items:                178 </span></span>
<span><span class="co">##   Proportion of size:            0.050857</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="stage-3-executing-the-audit">Stage 3: Executing the audit<a class="anchor" aria-label="anchor" href="#stage-3-executing-the-audit"></a>
</h2>
<p>The selected sample can be isolated by indexing the
<code>sample</code> object from the sampling result.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 3: Isolate the sample for execution of the audit.</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="va">stage2</span><span class="op">$</span><span class="va">sample</span></span></code></pre></div>
<p>Next, the auditor can execute the audit by annotating the items in
the sample with their audit values (for exampling by writing the sample
to a <em>.csv</em> file using <code><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv()</a></code>. They can then
load the annotated sample back into the R session for further
evaluation. For this example, the audit values of the sample items are
already included in the <code>auditValue</code> column of the data
set.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To write the sample to a .csv file:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample</span>, file <span class="op">=</span> <span class="st">"auditSample.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To load annotated sample back into R:</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"auditSample.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="stage-4-evaluating-the-sample">Stage 4: Evaluating the sample<a class="anchor" aria-label="anchor" href="#stage-4-evaluating-the-sample"></a>
</h2>
<p align="center">
<img src="evaluation.png" alt="evaluation" width="100%"></p>
<p>Using the annotated sample, the auditor can perform inference about
the misstatement in the population via the <code><a href="../reference/evaluation.html">evaluation()</a></code>
function. By passing the <code>prior</code> object to the function, it
automatically sets <code>method = "binomial"</code> to be consistent
with the prior distribution.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 4: Evaluate the sample.</span></span>
<span><span class="va">stage4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span></span>
<span>  materiality <span class="op">=</span> <span class="va">materiality</span>, conf.level <span class="op">=</span> <span class="va">confidence</span>, data <span class="op">=</span> <span class="va">sample</span>,</span>
<span>  values <span class="op">=</span> <span class="st">"bookValue"</span>, values.audit <span class="op">=</span> <span class="st">"auditValue"</span>, prior <span class="op">=</span> <span class="va">prior</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The auditor can inspect the outcomes of their inference by using the
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function. The resulting upper bound is 2.278%,
which is lower than the performance materiality of 5%. Therefore, the
auditor can concluse that there is a 95% probability that the
misstatement in BuildIt’s population is lower than 2.278%.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">stage4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bayesian Audit Sample Evaluation Summary</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Options:</span></span>
<span><span class="co">##   Confidence level:               0.95 </span></span>
<span><span class="co">##   Materiality:                    0.05 </span></span>
<span><span class="co">##   Hypotheses:                     H₀: Θ &gt; 0.05 vs. H₁: Θ &lt; 0.05 </span></span>
<span><span class="co">##   Method:                         poisson </span></span>
<span><span class="co">##   Prior distribution:             gamma(α = 2.325, β = 53) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   Sample size:                    178 </span></span>
<span><span class="co">##   Number of errors:               0 </span></span>
<span><span class="co">##   Sum of taints:                  0 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results:</span></span>
<span><span class="co">##   Posterior distribution:         gamma(α = 2.325, β = 231) </span></span>
<span><span class="co">##   Most likely error:              0.0057359 </span></span>
<span><span class="co">##   95 percent credible interval:   [0, 0.022781] </span></span>
<span><span class="co">##   Precision:                      0.017045 </span></span>
<span><span class="co">##   BF₁₀:                            2179.8</span></span></code></pre>
<p>They can inspect the prior and posterior distribution by using the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stage4</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayesian-sampling-workflow_files/figure-html/unnamed-chunk-17-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Since the 95% upper credible bound on the misstatement in population
is lower than the performance materiality, the auditor has obtained
sufficient evidence to conclude that the population does not contain
material misstatements. The auditor can create a <code>html</code> or
<code>pdf</code> report of the statistical results using the
<code><a href="../reference/report.html">report()</a></code> function, as shown below.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/report.html">report</a></span><span class="op">(</span><span class="va">stage4</span>, file <span class="op">=</span> <span class="st">"report.html"</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://koenderks.com" class="external-link">Koen Derks</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
